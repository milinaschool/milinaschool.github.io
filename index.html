<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©´ì ‘ ì—°ìŠµ í”„ë¡œê·¸ë¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #f0ede8;
            min-height: 100vh;
            padding: 0;
            color: #1a1a1a;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #faf9f7;
            min-height: 100vh;
            box-shadow: 0 0 0 1px rgba(0,0,0,0.08);
        }

        .header {
            background: #faf9f7;
            border-bottom: 1px solid #d8d4cf;
            padding: 24px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header h1 {
            font-size: 1.5em;
            font-weight: 600;
            color: #1a1a1a;
            letter-spacing: -0.02em;
        }

        .tabs {
            display: flex;
            background: #faf9f7;
            border-bottom: 1px solid #d8d4cf;
            padding: 0 40px;
            gap: 2px;
        }

        .tab {
            padding: 14px 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95em;
            color: #6b7280;
            transition: all 0.2s ease;
            border: none;
            background: transparent;
            border-bottom: 2px solid transparent;
            position: relative;
        }

        .tab:hover {
            color: #374151;
            background: #f0ede8;
        }

        .tab.active {
            color: #c97f66;
            border-bottom-color: #c97f66;
            background: transparent;
        }

        .tab-content {
            display: none;
            padding: 32px 40px;
            background: #faf9f7;
        }

        .tab-content.active {
            display: block;
        }

        /* ì—°ìŠµ íƒ­ ìŠ¤íƒ€ì¼ */
        .practice-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
        }

        .question-section {
            background: #faf9f7;
            padding: 0;
        }

        .category-selector {
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .category-selector label {
            font-weight: 500;
            color: #374151;
            font-size: 0.95em;
        }

        .category-selector select {
            padding: 8px 12px;
            border: 1px solid #d8d4cf;
            border-radius: 6px;
            font-size: 0.95em;
            cursor: pointer;
            background: white;
            color: #1a1a1a;
            transition: border-color 0.2s;
        }

        .category-selector select:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }

        .question-display {
            background: white;
            padding: 24px;
            border-radius: 8px;
            margin: 20px 0;
            min-height: 150px;
            border: 1px solid #e8e5e0;
        }

        .question-number {
            color: #6b7280;
            font-weight: 500;
            font-size: 0.85em;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .question-text {
            font-size: 1.25em;
            color: #1a1a1a;
            line-height: 1.6;
            font-weight: 500;
        }

        .controls {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: #c97f66;
            color: white;
        }

        .btn-primary:hover {
            background: #b86f58;
        }

        .btn-record {
            background: #a85b47;
            color: white;
            font-size: 1em;
            padding: 12px 24px;
        }

        .btn-record:hover {
            background: #924d3a;
        }

        .btn-record.recording {
            background: #7c9473;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .btn-secondary {
            background: #e8e5e0;
            color: #374151;
            border: 1px solid #d8d4cf;
        }

        .btn-secondary:hover {
            background: #d8d4cf;
        }

        .btn-success {
            background: #7c9473;
            color: white;
        }

        .btn-success:hover {
            background: #6b8064;
        }

        .btn-danger {
            background: #c97f66;
            color: white;
        }

        .btn-danger:hover {
            background: #b86f58;
        }

        .btn-small {
            padding: 6px 14px;
            font-size: 0.875em;
        }
        
        .btn-icon {
             padding: 6px 8px;
             font-size: 0.8em;
             line-height: 1;
        }

        /* í† ê¸€ ìŠ¤ìœ„ì¹˜ ìŠ¤íƒ€ì¼ */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding: 12px;
            background: #f5f3f0;
            border-radius: 6px;
            border: 1px solid #e8e5e0;
        }

        .toggle-label {
            font-weight: 500;
            color: #374151;
            font-size: 0.95em;
            flex: 1;
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
            background: #d8d4cf;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #7c9473;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(24px);
        }

        .toggle-description {
            font-size: 0.85em;
            color: #6b7280;
            margin-top: 4px;
        }

        /* í”„ë¦¬ì…‹ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .preset-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .preset-card {
            background: white;
            border: 2px solid #e8e5e0;
            border-radius: 8px;
            padding: 16px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .preset-card:hover {
            border-color: #c97f66;
            box-shadow: 0 4px 12px rgba(201, 127, 102, 0.15);
            transform: translateY(-2px);
        }
        
        .preset-card.active {
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.2);
        }
        
        .preset-card.active:hover {
            transform: translateY(0);
        }


        .preset-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .preset-card-title {
            font-weight: 600;
            font-size: 1.05em;
            color: #1a1a1a;
            word-break: break-word;
            flex: 1;
        }

        .preset-card-meta {
            font-size: 0.85em;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .preset-card-actions {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #f0ede8;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .preset-save-section {
            background: #f5f3f0;
            padding: 16px;
            border-radius: 8px;
            border: 2px dashed #d8d4cf;
            margin-bottom: 20px;
        }

        .preset-save-section h4 {
            font-size: 1em;
            color: #374151;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .preset-input-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .preset-input-group input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #d8d4cf;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .preset-input-group input:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }


        .timer {
            background: #f5e6d3;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 1.5em;
            font-weight: 600;
            color: #8b5a3c;
            text-align: center;
            margin: 20px 0;
            border: 1px solid #e8d5bc;
        }

        .transcription-area {
            background: white;
            border: 1px solid #e8e5e0;
            border-radius: 8px;
            padding: 20px;
            min-height: 150px;
            margin: 20px 0;
        }

        .transcription-area h3 {
            font-size: 0.95em;
            color: #6b7280;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .transcription-text {
            width: 100%;
            min-height: 200px;
            border: 1px solid #e8e5e0;
            border-radius: 6px;
            padding: 12px;
            font-size: 0.95em;
            font-family: inherit;
            resize: vertical;
            background: white;
        }

        .transcription-text:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }

        .history-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e8e5e0;
        }

        .history-panel h2 {
            font-size: 1.1em;
            margin-bottom: 16px;
            color: #1a1a1a;
            font-weight: 600;
        }

        .answer-card {
            background: #faf9f7;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 12px;
            border: 1px solid #e8e5e0;
        }

        .answer-question {
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .answer-meta {
            font-size: 0.85em;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .answer-text {
            color: #374151;
            font-size: 0.9em;
            line-height: 1.6;
            margin-bottom: 12px;
            white-space: pre-wrap;
        }

        .answer-actions {
            display: flex;
            gap: 8px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }

        /* ì§ˆë¬¸ ê´€ë¦¬ ìŠ¤íƒ€ì¼ */
        .manager-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .manager-header h2 {
            font-size: 1.5em;
            color: #1a1a1a;
            font-weight: 600;
        }

        .manager-controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .file-input-wrapper input[type="file"] {
            display: none;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e8e5e0;
        }

        .stat-value {
            font-size: 2em;
            font-weight: 600;
            color: #c97f66;
            margin-bottom: 4px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.9em;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d8d4cf;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .search-box input:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }

        .management-section {
            background: white;
            padding: 24px;
            border-radius: 8px;
            border: 1px solid #e8e5e0;
            margin-bottom: 24px;
        }

        .management-header {
            margin-bottom: 20px;
        }

        .management-header h3 {
            font-size: 1.25em;
            margin-bottom: 8px;
            color: #1a1a1a;
            font-weight: 600;
        }

        .management-header p {
            font-size: 0.9em;
            color: #6b7280;
        }

        #category-list-new {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .category-list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: #faf9f7;
            border: 1px solid #e8e5e0;
            border-radius: 6px;
        }

        .category-info-new {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .category-name-badge {
            font-weight: 500;
            padding: 4px 12px;
            background: white;
            border: 1px solid #d8d4cf;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .question-count-badge {
            font-size: 0.9em;
            color: #6b7280;
        }

        .accordion-item {
            border: 1px solid #e8e5e0;
            border-radius: 6px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #faf9f7;
            cursor: pointer;
            transition: background-color 0.2s ease;
            flex-wrap: wrap; /* ëª¨ë°”ì¼ ëŒ€ì‘ */
            gap: 12px; /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        }

        .accordion-header:hover {
            background: #f0ede8;
        }
        
        .accordion-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            color: #1a1a1a;
            flex: 1;
            min-width: 150px; /* ì¤„ë°”ê¿ˆ ìµœì†Œ ë„ˆë¹„ */
            overflow: hidden;
        }
        
        .accordion-header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-icon {
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }

        .accordion-header.active .toggle-icon {
            transform: rotate(90deg);
        }

        .accordion-content {
            display: none;
            padding: 16px;
            background: white;
            border-top: 1px solid #e8e5e0;
        }

        .question-list-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0ede8;
        }
        .question-list-item:last-child {
            border-bottom: none;
        }

        .question-number-new {
            color: #6b7280;
            font-size: 0.9em;
            width: 30px;
        }

        .question-text-view {
            flex: 1;
            color: #374151;
        }

        .inline-add-form {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px dashed #d8d4cf;
        }

        .inline-add-form input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d8d4cf;
            border-radius: 6px;
            font-size: 0.95em;
        }
        .inline-add-form input:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }
        
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            animation: modal-fade-in 0.3s ease;
        }
        
        @keyframes modal-fade-in {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid #e8e5e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.25em;
            font-weight: 600;
            color: #1a1a1a;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .close-btn:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .modal-body {
            padding: 24px;
        }

        .modal form {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d8d4cf;
            border-radius: 6px;
            font-size: 0.95em;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #c97f66;
            box-shadow: 0 0 0 3px rgba(201, 127, 102, 0.1);
        }

        .modal-footer {
            padding: 16px 24px;
            background: #f9fafb;
            border-top: 1px solid #e8e5e0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            border-bottom-left-radius: 12px;
            border-bottom-right-radius: 12px;
        }


        .status-message {
            padding: 12px 16px;
            border-radius: 6px;
            margin: 15px 0;
            font-weight: 500;
            font-size: 0.95em;
        }

        .status-info {
            background: #e8f0f5;
            color: #2c5f7a;
            border: 1px solid #c5dae8;
        }

        .status-success {
            background: #e8f2e5;
            color: #4a6b42;
            border: 1px solid #c5ddc0;
        }

        .status-error {
            background: #f5e6e0;
            color: #8b5a3c;
            border: 1px solid #e8d5bc;
        }

        .warning-box {
            background: #fef3c7;
            border: 1px solid #fde68a;
            padding: 16px;
            border-radius: 6px;
            margin: 20px 40px 0;
            color: #92400e;
            font-size: 0.9em;
        }
        .warning-box code {
            background: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            color: #333;
        }

        @media (max-width: 768px) {
            .header, .tabs, .warning-box {
                padding-left: 20px;
                padding-right: 20px;
                margin-left: 0;
                margin-right: 0;
            }
            .header h1 {
                font-size: 1.1em;
            }
            .tab-content {
                padding: 24px 20px;
            }
            .btn-secondary {
                font-size: 0.85em;
                padding: 8px 12px;
            }
            .practice-layout {
                grid-template-columns: 1fr;
            }
            .tabs {
                overflow-x: auto;
            }
            .tab {
                white-space: nowrap;
            }
            .manager-header {
                flex-direction: column;
                align-items: stretch;
            }
            .manager-controls {
                width: 100%;
            }
            .manager-controls button,
            .manager-controls .file-input-wrapper {
                flex: 1;
            }
            .manager-controls .file-input-wrapper button {
                width: 100%;
            }
            #focus-question-text {
                font-size: 1.5em;
            }
            .category-list-item .category-name-badge {
                display: none;
            }
        }
        
        /* ì§‘ì¤‘ ëª¨ë“œ ìŠ¤íƒ€ì¼ */
        #focusModeContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            color: white;
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 40px;
        }

        #focusModeContainer.active {
            display: flex;
            opacity: 1;
        }

        .focus-controls-top {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 12px;
        }

        #focusCategorySelect, #exitFocusBtn {
            background: #333;
            color: white;
            border: 1px solid #555;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
        }

        #focus-question-text {
            font-size: 2em;
            font-weight: 500;
            max-width: 800px;
            margin-bottom: 40px;
            min-height: 100px;
        }

        #focus-circle {
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s ease-out, background-color 0.3s ease, border 0.3s ease;
            box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);
        }

        #focus-circle:hover {
            transform: scale(1.05);
        }

        #focus-circle.waiting {
            animation: pulse-white 2s infinite;
        }

        #focus-circle.listening {
            background-color: #ffcdd2; /* ë¶‰ì€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
            border: 2px solid #e57373;   /* í…Œë‘ë¦¬ ì¶”ê°€ */
        }

        @keyframes pulse-white {
            0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(255, 255, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }

        #focus-status-text {
            margin-top: 30px;
            font-size: 1.1em;
            color: #aaa;
            height: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ ë©´ì ‘ ì—°ìŠµ í”„ë¡œê·¸ë¨</h1>
        </div>
        
        <div id="setupWarning" class="warning-box" style="display: none;">
            <strong>âš ï¸ ìŒì„± ì¸ì‹ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¡œì»¬ ì„œë²„ ë˜ëŠ” HTTPSê°€ í•„ìš”í•©ë‹ˆë‹¤!</strong><br>
            í˜„ì¬ <code>file://</code> í”„ë¡œí† ì½œë¡œ ì‹¤í–‰ ì¤‘ì´ì–´ì„œ ìŒì„± ì¸ì‹ì´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
            <em>â€» ìŒì„± ì¸ì‹ ì—†ì´ í…ìŠ¤íŠ¸ë§Œ ì…ë ¥í•´ì„œ ì‚¬ìš©í•˜ì…”ë„ ë©ë‹ˆë‹¤.</em>
        </div>

        <div style="padding: 12px 40px; margin: 0; display: none;" id="recognitionStatusBar">
            <div style="display: flex; align-items: center; gap: 10px; padding: 8px 12px; border-radius: 6px; border-left: 4px solid;">
                <span id="recognitionStatusIcon" style="font-size: 1.2em;"></span>
                <span id="recognitionStatusText" style="font-weight: 500;"></span>
            </div>
        </div>


        <div class="tabs">
            <button class="tab active" onclick="switchTab('practice')">ì—°ìŠµ</button>
            <button class="tab" onclick="switchTab('questions')">ì§ˆë¬¸ ë°ì´í„°ë² ì´ìŠ¤</button>
            <button class="tab" onclick="switchTab('answers')">ë‹µë³€ ê¸°ë¡</button>
            <button class="tab" onclick="switchTab('stats')">í†µê³„</button>
        </div>

        <!-- ì—°ìŠµ íƒ­ -->
        <div id="practice-tab" class="tab-content active">
            <div class="practice-layout">
                <div class="question-section">
                    <div class="category-selector">
                        <label>ì¹´í…Œê³ ë¦¬:</label>
                        <select id="categorySelect">
                            <option value="all">ì „ì²´</option>
                        </select>
                    </div>

                    <div class="question-display" id="questionDisplay">
                        <div class="question-number">ì§ˆë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                        <div class="question-text">"ìƒˆ ì§ˆë¬¸" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”</div>
                    </div>

                    <div class="controls">
                        <button class="btn-primary" onclick="getNewQuestion()">ìƒˆ ì§ˆë¬¸</button>
                        <button class="btn-record" id="recordBtn" onclick="toggleRecording()">ë…¹ìŒ ì‹œì‘</button>
                        <button class="btn-secondary" onclick="resetTimer()">íƒ€ì´ë¨¸ ë¦¬ì…‹</button>
                    </div>

                    <div class="timer" id="timer">00:00</div>

                    <div class="transcription-area">
                        <h3>ë‹µë³€ ë‚´ìš© (ìˆ˜ì • ê°€ëŠ¥)</h3>
                        <textarea class="transcription-text" id="transcriptionText" placeholder="ë…¹ìŒì„ ì‹œì‘í•˜ë©´ ì—¬ê¸°ì— í…ìŠ¤íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤..."></textarea>
                    </div>

                    <div class="controls">
                        <button class="btn-success" onclick="saveAnswer()">ë‹µë³€ ì €ì¥</button>
                        <button class="btn-secondary" onclick="clearTranscription()">ë‚´ìš© ì§€ìš°ê¸°</button>
                    </div>

                    <div id="statusMessage"></div>
                </div>

                <div class="history-panel">
                    <h2>ìµœê·¼ ë‹µë³€ (5ê°œ)</h2>
                    <div id="recentAnswers"></div>
                </div>
            </div>
        </div>

        <!-- ì§ˆë¬¸ ê´€ë¦¬ íƒ­ -->
        <div id="questions-tab" class="tab-content">
            <div class="manager-header">
                <h2>ì§ˆë¬¸ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬</h2>
                <div class="manager-controls">
                    <button class="btn-secondary" onclick="exportAllPresets()">ì „ì²´ í”„ë¦¬ì…‹ ë‚´ë³´ë‚´ê¸°</button>
                    <div class="file-input-wrapper">
                        <input type="file" id="presetImportFile" accept=".json" onchange="importAllPresets(event)">
                        <button class="btn-secondary" onclick="document.getElementById('presetImportFile').click()">ì „ì²´ í”„ë¦¬ì…‹ ê°€ì ¸ì˜¤ê¸°</button>
                    </div>
                </div>
            </div>
            
            <!-- í”„ë¦¬ì…‹ ê´€ë¦¬ ì„¹ì…˜ -->
            <div class="management-section">
                <div class="management-header">
                    <h3>í”„ë¦¬ì…‹ ê´€ë¦¬</h3>
                    <p>í”„ë¦¬ì…‹ì„ ì„ íƒí•˜ì—¬ ì—°ìŠµí•  ì§ˆë¬¸ ëª©ë¡ì„ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§ˆë¬¸/ì¹´í…Œê³ ë¦¬ë¥¼ ìˆ˜ì •í•˜ë©´ í˜„ì¬ ì„ íƒëœ í”„ë¦¬ì…‹ì— ìë™ ì €ì¥ë©ë‹ˆë‹¤.</p>
                </div>
                
                <div class="controls">
                    <button class="btn-primary" onclick="addBlankPreset()">+ ë¹ˆ í”„ë¦¬ì…‹ ì¶”ê°€</button>
                    <div class="file-input-wrapper">
                         <input type="file" id="singlePresetImportFile" accept=".json" onchange="importSinglePreset(event)">
                         <button class="btn-secondary" onclick="document.getElementById('singlePresetImportFile').click()">í”„ë¦¬ì…‹ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                    </div>
                </div>

                <!-- ì €ì¥ëœ í”„ë¦¬ì…‹ ëª©ë¡ -->
                <div id="presetCardsContainer">
                    <!-- í”„ë¦¬ì…‹ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <div class="management-section">
                <div class="management-header">
                    <h3>ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ (í˜„ì¬ í”„ë¦¬ì…‹: <span id="currentPresetNameForCategory" style="color: #c97f66; font-weight: bold;"></span>)</h3>
                    <p>í˜„ì¬ í™œì„±í™”ëœ í”„ë¦¬ì…‹ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                </div>
                <div id="category-list-new">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì´ ìƒì„±ë©ë‹ˆë‹¤. -->
                </div>
                <button class="btn-primary" onclick="openAddCategoryModal()">+ ìƒˆ ì¹´í…Œê³ ë¦¬ ì¶”ê°€</button>
            </div>

            <div class="management-section">
                <div class="management-header">
                    <h3>ì§ˆë¬¸ ê´€ë¦¬</h3>
                    <p>ê° ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•˜ì—¬ í¼ì¹˜ê±°ë‚˜ ì ‘ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div id="question-accordion-list">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì•„ì½”ë””ì–¸ ëª©ë¡ì´ ìƒì„±ë©ë‹ˆë‹¤. -->
                </div>
            </div>
        </div>

        <!-- ë‹µë³€ ê´€ë¦¬ íƒ­ -->
        <div id="answers-tab" class="tab-content">
            <div class="answer-manager">
                <div class="manager-header">
                    <h2>ë‹µë³€ ê¸°ë¡ ê´€ë¦¬</h2>
                    <div class="manager-controls">
                        <button class="btn-primary" onclick="exportAnswers()">ë‹µë³€ ë‚´ë³´ë‚´ê¸°</button>
                        <div class="file-input-wrapper">
                            <input type="file" id="answerImportFile" accept=".json" onchange="importAnswers(event)">
                            <button class="btn-secondary" onclick="document.getElementById('answerImportFile').click()">ë‹µë³€ ê°€ì ¸ì˜¤ê¸°</button>
                        </div>
                        <button class="btn-danger" onclick="clearAllAnswers()">ì „ì²´ ì‚­ì œ</button>
                    </div>
                </div>

                <!-- ë…¹ìŒ ê¸°ëŠ¥ í† ê¸€ -->
                <div class="toggle-container">
                    <div style="flex: 1;">
                        <div class="toggle-label">ğŸ™ï¸ ìŒì„± ë…¹ìŒ ê¸°ëŠ¥</div>
                        <div class="toggle-description">í™œì„±í™”í•˜ë©´ ë‹µë³€ ì‹œ ìŒì„±ì´ ë…¹ìŒë˜ì–´ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜¤í”„ë¼ì¸ì—ì„œë„ ë…¹ìŒ ê°€ëŠ¥í•©ë‹ˆë‹¤. (ìŒì„± ì¸ì‹ì€ ì¸í„°ë„· í•„ìš”)</div>
                    </div>
                    <div class="toggle-switch" id="audioRecordingToggle" onclick="toggleAudioRecording()">
                        <div class="toggle-slider"></div>
                    </div>
                </div>

                <div class="search-box">
                    <input type="text" id="answerSearch" placeholder="ë‹µë³€ ê²€ìƒ‰..." oninput="filterAnswers()">
                </div>

                <div id="answerList"></div>
            </div>
        </div>

        <!-- í†µê³„ íƒ­ -->
        <div id="stats-tab" class="tab-content">
            <h2 style="margin-bottom: 24px; font-size: 1.5em;">ì—°ìŠµ í†µê³„</h2>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="statsQuestionsCount">0</div>
                    <div class="stat-label">í˜„ì¬ í”„ë¦¬ì…‹ ì§ˆë¬¸ ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statsCategoryCount">0</div>
                    <div class="stat-label">í˜„ì¬ í”„ë¦¬ì…‹ ì¹´í…Œê³ ë¦¬ ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statsAnswersCount">0</div>
                    <div class="stat-label">ì €ì¥ëœ ë‹µë³€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statsPracticeTime">0</div>
                    <div class="stat-label">ì´ ì—°ìŠµ ì‹œê°„ (ë¶„)</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì§ˆë¬¸ ì¶”ê°€/í¸ì§‘ ëª¨ë‹¬ -->
    <div id="questionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ì§ˆë¬¸ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeQuestionModal()">Ã—</button>
            </div>
            <form id="questionForm" onsubmit="saveQuestion(event)">
                <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬*</label>
                    <select id="questionCategory" required>
                    </select>
                </div>
                <div class="form-group">
                    <label>ì§ˆë¬¸ ë‚´ìš©*</label>
                    <textarea id="questionText" required placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                </div>
                <input type="hidden" id="questionId">
                <div class="controls">
                    <button type="submit" class="btn-success">ì €ì¥</button>
                    <button type="button" class="btn-secondary" onclick="closeQuestionModal()">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì¹´í…Œê³ ë¦¬ ì¶”ê°€/í¸ì§‘ ëª¨ë‹¬ -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="categoryModalTitle">ì¹´í…Œê³ ë¦¬ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeCategoryModal()">Ã—</button>
            </div>
            <form id="categoryForm" onsubmit="saveCategory(event)">
                <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬ ID* (ì˜ë¬¸, ìˆ«ì, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ ê°€ëŠ¥)</label>
                    <input type="text" id="categoryId" required pattern="[a-zA-Z0-9_]+" placeholder="ì˜ˆ: personality">
                </div>
                <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬ ì´ë¦„*</label>
                    <input type="text" id="categoryName" required placeholder="ì˜ˆ: ì¸ì„±/ê°€ì¹˜ê´€">
                </div>
                <input type="hidden" id="editingCategoryId">
                <div class="controls">
                    <button type="submit" class="btn-success">ì €ì¥</button>
                    <button type="button" class="btn-secondary" onclick="closeCategoryModal()">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ì§‘ì¤‘ ëª¨ë“œ ì»¨í…Œì´ë„ˆ -->
    <div id="focusModeContainer">
        <div class="focus-controls-top">
            <select id="focusCategorySelect"></select>
            <button id="exitFocusBtn">ë‚˜ê°€ê¸°</button>
        </div>
        <div id="focus-question-text">
            ì§‘ì¤‘ ëª¨ë“œë¥¼ ì‹œì‘í•˜ë ¤ë©´ ì¤‘ì•™ì˜ ì›ì„ í´ë¦­í•˜ì„¸ìš”.
        </div>
        <div id="focus-circle"></div>
        <div id="focus-status-text"></div>
    </div>

    <!-- ì»¤ìŠ¤í…€ í™•ì¸ ëª¨ë‹¬ -->
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h3 id="confirmModalTitle">í™•ì¸</h3>
                <button class="close-btn" onclick="hideConfirmModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="confirmModalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="confirmModalCancelBtn" class="btn-secondary" onclick="hideConfirmModal()">ì·¨ì†Œ</button>
                <button id="confirmModalConfirmBtn" class="btn-primary">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ëª¨ë‹¬ -->
    <div id="promptModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 id="promptModalTitle">ì…ë ¥</h3>
                <button class="close-btn" onclick="hidePromptModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="promptModalMessage" style="margin-bottom: 12px;"></p>
                <input type="text" id="promptModalInput" class="form-group" style="width: 100%;">
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="hidePromptModal()">ì·¨ì†Œ</button>
                <button id="promptModalConfirmBtn" class="btn-primary">í™•ì¸</button>
            </div>
        </div>
    </div>

    <script>
        // --- ê¸°ë³¸ í”„ë¦¬ì…‹ ë°ì´í„° ---
        const defaultPresetInterview = {
            name: "ë©´ì ‘ìš© ì—°ìŠµì§ˆë¬¸",
            timestamp: new Date().toISOString(),
            categories: { basic: "ê¸°ë³¸ ì§ˆë¬¸", academic: "í•™ì—…/íƒêµ¬", personality: "ì¸ì„±/ê°€ì¹˜ê´€", department: "í•™ê³¼/ì§„ë¡œ", technical: "ì „ê³µ ê´€ë ¨" },
            questions: { basic: ["ê°„ë‹¨í•˜ê²Œ ìê¸°ì†Œê°œë¥¼ í•´ì£¼ì„¸ìš”.", "ìì‹ ì˜ ì¥ì ì„ êµ¬ì²´ì ì¸ ì‚¬ë¡€ì™€ í•¨ê»˜ ë§ì”€í•´ì£¼ì„¸ìš”.", "ìì‹ ì˜ ë‹¨ì ì€ ë¬´ì—‡ì´ê³ , ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì–´ë–¤ ë…¸ë ¥ì„ í•˜ê³  ìˆë‚˜ìš”?", "ë³¸ ëŒ€í•™êµ, ë³¸ í•™ê³¼ì— ì§€ì›í•œ ë™ê¸°ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ë§ˆì§€ë§‰ìœ¼ë¡œ í•˜ê³  ì‹¶ì€ ë§ì”€ì´ ìˆìœ¼ì‹ ê°€ìš”?",], academic: ["ê³ ë“±í•™êµì—ì„œ ê°€ì¥ ì—´ì‹¬íˆ ê³µë¶€í•œ ê³¼ëª©ê³¼ ê·¸ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "í•™ìƒë¶€ì—ì„œ ê°€ì¥ ì¸ìƒ ê¹Šì€ íƒêµ¬í™œë™ì„ ì†Œê°œí•´ì£¼ì„¸ìš”.", "íƒêµ¬í™œë™ì„ í•˜ë©´ì„œ ê°€ì¥ ì–´ë ¤ì› ë˜ ì ê³¼ ê·¹ë³µ ê³¼ì •ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.", "í•™ì—… ì„±ì ì´ ë‚®ì€ ê³¼ëª©ì´ ìˆë‹¤ë©´ ê·¸ ì´ìœ ì™€ ê°œì„  ë…¸ë ¥ì„ ë§ì”€í•´ì£¼ì„¸ìš”.", "ê³ êµ 3ë…„ê°„ ê°€ì¥ ì˜ë¯¸ ìˆì—ˆë˜ í™œë™(ì„±ì·¨)ì€ ë¬´ì—‡ì¸ê°€ìš”? ê·¸ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ìì‹ ë§Œì˜ í•™ìŠµ ë°©ë²•ì´ë‚˜ ì‹œê°„ ê´€ë¦¬ ë…¸í•˜ìš°ê°€ ìˆë‚˜ìš”?"], personality: ["ë¦¬ë”ì‹­ì„ ë°œíœ˜í•œ ê²½í—˜ì´ ìˆë‚˜ìš”? êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”.", "íŒ€ í”„ë¡œì íŠ¸ì—ì„œ ë¦¬ë” ì—­í• ì„ ë§¡ì•˜ë˜ ê²½í—˜ì„ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”.", "ë¦¬ë”ì‹­ê³¼ íŒ”ë¡œì›Œì‹­ ì¤‘ ìì‹ ì€ ì–´ëŠ ìª½ì— ë” ê°€ê¹Œìš´ê°€ìš”?", "ê°ˆë“± ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”? êµ¬ì²´ì ì¸ ì‚¬ë¡€ë¥¼ ë“¤ì–´ ì„¤ëª…í•´ì£¼ì„¸ìš”.", "íƒ€ì¸ê³¼ ì˜ê²¬ì´ ë‹¤ë¥¼ ë•Œ ì–´ë–»ê²Œ ì¡°ìœ¨í•˜ë‚˜ìš”?", "ëª¨ë‘  í™œë™ì— ì œëŒ€ë¡œ ì°¸ì—¬í•˜ì§€ ì•ŠëŠ” ì¹œêµ¬ê°€ ìˆë‹¤ë©´ ì–´ë–»ê²Œ í• ê±´ê°€ìš”?", "ì¹œêµ¬ê°€ ì–´ë ¤ì›€ì— ì²˜í–ˆì„ ë•Œ ë„ì™€ì¤€ ê²½í—˜ì´ ìˆë‚˜ìš”?", "ì‹¤íŒ¨í•œ ê²½í—˜ê³¼ ê·¸ë¡œë¶€í„° ë°°ìš´ ì ì„ ë§ì”€í•´ì£¼ì„¸ìš”.", "ì§€ê¸ˆê¹Œì§€ ì‚´ì•„ì˜¤ë©´ì„œ ê²ªì—ˆë˜ ê°€ì¥ í˜ë“¤ì—ˆë˜ ê²½í—˜ì€ ë¬´ì—‡ì´ê³  ì–´ë–»ê²Œ ê·¹ë³µí–ˆë‚˜ìš”?", "ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ì„ ë•Œ ì–´ë–»ê²Œ í•´ì†Œí•˜ë‚˜ìš”?", "ìƒˆë¡œìš´ í™˜ê²½ì— ì ì‘í•˜ëŠ” ìì‹ ë§Œì˜ ë°©ë²•ì´ ìˆë‚˜ìš”?", "ìµœê·¼ì— ì½ì€ ì±… ì¤‘ ê°€ì¥ ì¸ìƒ ê¹Šì—ˆë˜ ì±…ê³¼ ê·¸ ì´ìœ ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”.", "ì¡´ê²½í•˜ëŠ” ì¸ë¬¼ì´ ìˆë‹¤ë©´ ëˆ„êµ¬ì´ë©°, ê·¸ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ë´‰ì‚¬í™œë™ ì¤‘ ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” í™œë™ì´ ìˆë‚˜ìš”?", "ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ê´€ì€ ë¬´ì—‡ì¸ê°€ìš”?"], department: ["ëŒ€í•™ ì…í•™ í›„ ê°€ì¥ ë¨¼ì € í•˜ê³  ì‹¶ì€ ì¼ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì…í•™ í›„ í•™ì—…ê³„íšì„ ë§í•´ì£¼ì„¸ìš”.", "10ë…„ í›„ ìì‹ ì˜ ëª¨ìŠµì€ ì–´ë–¨ ê²ƒ ê°™ë‚˜ìš”?", "ì¡¸ì—… í›„ ì§„ë¡œ ê³„íšì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?", "ì´ í•™ê³¼ì—ì„œ ê°€ì¥ ë“£ê³  ì‹¶ì€ ê³¼ëª©ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì´ í•™ê³¼ì— ì§€ì›í•˜ê¸° ìœ„í•´ ì–´ë–¤ ë…¸ë ¥ì„ í–ˆë‚˜ìš”?"], technical: [], }
        };
        const defaultPresetDaily = {
            name: "ì¼ìƒìš© ì—°ìŠµì§ˆë¬¸",
            timestamp: new Date().toISOString(),
            categories: { ice_breaking: "ê°€ë³ê²Œ ì‹œì‘í•˜ê¸° (ì•„ì´ìŠ¤ë¸Œë ˆì´í‚¹)", daily_life: "ì¼ìƒê³¼ ì·¨ë¯¸", preferences: "ì·¨í–¥ê³¼ ìƒê°", imagination: "ìƒìƒê³¼ ê°€ì •", reflection: "ê°€ë²¼ìš´ íšŒê³ ì™€ ê¸°ëŒ€" },
            questions: { ice_breaking: ["ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ë‚˜ìš”?", "ì—¬ê¸°ê¹Œì§€ ì–´ë–»ê²Œ ì˜¤ì…¨ì–´ìš”? ì˜¤ëŠ” ê¸¸ì— ì¬ë¯¸ìˆëŠ” ì¼ì€ ì—†ì—ˆë‚˜ìš”?", "ìš”ì¦˜ ê°€ì¥ ë§ì´ ë“£ëŠ” ë…¸ë˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ì•„ì¹¨ì— ì¼ì–´ë‚˜ì„œ ê°€ì¥ ë¨¼ì € í•˜ëŠ” ì¼ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì§€ê¸ˆ ê°€ì¥ ë¨¹ê³  ì‹¶ì€ ìŒì‹ì´ ìˆë‹¤ë©´ìš”?", "ìµœê·¼ì— ê°€ì¥ í¬ê²Œ ì›ƒì—ˆë˜ ì ì€ ì–¸ì œì¸ê°€ìš”?", "ì§€ê¸ˆ ê¸°ë¶„ì€ ì–´ë– ì‹ ê°€ìš”?", "ì˜¤ëŠ˜ ì•„ì¹¨ ì‹ì‚¬ëŠ” ë¬´ì—‡ì„ í•˜ì…¨ë‚˜ìš”?", "ì˜¤ëŠ˜ ë‚ ì”¨ ì–´ë–¤ê°€ìš”? ë‚ ì”¨ ë•Œë¬¸ì— ê¸°ë¶„ì´ ì˜í–¥ ë°›ëŠ” í¸ì¸ê°€ìš”?", "ì§€ê¸ˆ ì…ê³  ìˆëŠ” ì˜· ì¤‘ì—ì„œ ê°€ì¥ ë§ˆìŒì— ë“œëŠ” ì•„ì´í…œì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì˜¤ëŠ˜ ì§‘ ë‚˜ì˜¤ê¸° ì „ì— ê°€ì¥ ë§ˆì§€ë§‰ìœ¼ë¡œ í•œ í–‰ë™ì€ ë­ì˜€ë‚˜ìš”?", "ì´ë²ˆ ì£¼ì— ê°€ì¥ ê¸°ëŒ€ë˜ëŠ” ì¼ì´ ìˆë‚˜ìš”?", "ìµœê·¼ì— ìƒˆë¡œ ì‹œë„í•´ë³¸ ê²ƒì´ ìˆë‚˜ìš”?", "ìš”ì¦˜ ê°€ì¥ ìì£¼ ì“°ëŠ” ì´ëª¨í‹°ì½˜ì´ë‚˜ ë°ˆì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì•„ì¹¨í˜• ì¸ê°„ì¸ê°€ìš”, ì €ë…í˜• ì¸ê°„ì¸ê°€ìš”?", "ì˜¤ëŠ˜ ì•„ì¹¨ì— ê¾¼ ê¿ˆ ê¸°ì–µë‚˜ì‹œë‚˜ìš”?", "ì§€ê¸ˆ ì´ ìˆœê°„ ì°½ë°–ì„ ë³´ë©´ ë¬´ì—‡ì´ ë³´ì´ë‚˜ìš”?", "ì˜¤ëŠ˜ ì œì¼ ë¨¼ì € ë§Œë‚œ ì‚¬ëŒì€ ëˆ„êµ¬ì˜€ë‚˜ìš”?", "ìš”ì¦˜ ê°€ì¥ ìì£¼ í•˜ëŠ” ìƒê°ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì¶œê·¼ê¸¸/ë“±êµê¸¸ì— ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë©´ì„œ ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?", "ì»¤í”¼ vs ì°¨, ì˜¤ëŠ˜ì€ ì–´ëŠ ìª½ ê¸°ë¶„ì¸ê°€ìš”?", "ì£¼ë¨¸ë‹ˆë‚˜ ê°€ë°©ì— í•­ìƒ ê°€ì§€ê³  ë‹¤ë‹ˆëŠ” ë¬¼ê±´ì´ ìˆë‚˜ìš”?", "ì˜¤ëŠ˜ ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” ëŒ€í™”ê°€ ìˆì—ˆë‚˜ìš”?", "ì§€ê¸ˆ í•¸ë“œí° ë°°ê²½í™”ë©´ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì˜¤ëŠ˜ í•˜ë£¨ ì¤‘ ê°€ì¥ ì¢‹ì•˜ë˜ ìˆœê°„ì€ ì–¸ì œì˜€ë‚˜ìš”?"], daily_life: ["í•™êµì—ì„œ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ì‹œê°„ì€ ì–¸ì œì¸ê°€ìš”? (ì ì‹¬ì‹œê°„, íŠ¹ì • ìˆ˜ì—…, ì‰¬ëŠ” ì‹œê°„ ë“±)", "ìŠ¤íŠ¸ë ˆìŠ¤ ë°›ì„ ë•Œ ë³´í†µ ì–´ë–»ê²Œ í‘¸ëŠ” í¸ì¸ê°€ìš”?", "ì£¼ë§ì—ëŠ” ë³´í†µ ë¬´ì—‡ì„ í•˜ë©´ì„œ ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?", "ê°€ì¥ ì¹œí•œ ì¹œêµ¬ì—ê²Œ ë‚˜ë¥¼ ì†Œê°œí•´ë‹¬ë¼ê³  í•œë‹¤ë©´, ë­ë¼ê³  í•  ê²ƒ ê°™ë‚˜ìš”?", "ìš”ì¦˜ ìƒˆë¡­ê²Œ ë¹ ì ¸ìˆëŠ” ì·¨ë¯¸ë‚˜ ê´€ì‹¬ì‚¬ê°€ ìˆë‚˜ìš”?", "ë‚˜ë§Œì˜ 'ì†Œí™•í–‰'(ì†Œì†Œí•˜ì§€ë§Œ í™•ì‹¤í•œ í–‰ë³µ)ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ê³µë¶€í•˜ê¸° ì‹«ì„ ë•Œ ìì‹ ì„ ë‹¤ë…ì´ëŠ” íŠ¹ë³„í•œ ë°©ë²•ì´ ìˆë‚˜ìš”?", "í•˜ë£¨ ì¤‘ ì–¸ì œê°€ ê°€ì¥ ê¸°ë¶„ì´ ì¢‹ì€ê°€ìš”?", "ì ë“¤ê¸° ì „ ë£¨í‹´ì´ ìˆë‚˜ìš”?", "ì ì‹¬ì‹œê°„ì— ì£¼ë¡œ ëˆ„êµ¬ì™€ í•¨ê»˜ ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?", "ë°© ì²­ì†ŒëŠ” ì–¼ë§ˆë‚˜ ìì£¼ í•˜ëŠ” í¸ì¸ê°€ìš”?", "ì¢‹ì•„í•˜ëŠ” ê³¼ëª©ê³¼ ì‹«ì–´í•˜ëŠ” ê³¼ëª©, ê·¸ë¦¬ê³  ê·¸ ì´ìœ ëŠ”?", "í•™ì›ì´ë‚˜ ë„ì„œê´€ë³´ë‹¤ ì§‘ì—ì„œ ê³µë¶€í•˜ëŠ” ê±¸ ì„ í˜¸í•˜ë‚˜ìš”?", "íœ´ëŒ€í° ì‚¬ìš© ì‹œê°„ì€ í•˜ë£¨ì— í‰ê·  ì–¼ë§ˆë‚˜ ë˜ë‚˜ìš”?", "ê°€ì¡±ë“¤ê³¼ëŠ” ì£¼ë¡œ ì–´ë–¤ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ë‚˜ìš”?", "í•™êµ ëë‚˜ê³  ì§‘ì— ê°€ëŠ” ê¸¸ì— ë“¤ë¥´ëŠ” ë‹¨ê³¨ ì¥ì†Œê°€ ìˆë‚˜ìš”?", "ì•¼ì‹ì„ ìì£¼ ë¨¹ëŠ” í¸ì¸ê°€ìš”? ì£¼ë¡œ ë­˜ ë¨¹ë‚˜ìš”?", "í˜¼ì ìˆëŠ” ì‹œê°„ê³¼ ì¹œêµ¬ë“¤ê³¼ ìˆëŠ” ì‹œê°„, ì–´ëŠ ìª½ì„ ë” ì¢‹ì•„í•˜ë‚˜ìš”?", "ì¼ì£¼ì¼ì— ìš´ë™ì€ ì–¼ë§ˆë‚˜ í•˜ëŠ” í¸ì¸ê°€ìš”?", "ì•„ì¹¨ì— ì¼ì–´ë‚˜ëŠ” ê²Œ í˜ë“  í¸ì¸ê°€ìš”?", "ì§€ê°ì„ ìì£¼ í•˜ëŠ” í¸ì¸ê°€ìš”, ì•„ë‹ˆë©´ í•­ìƒ ì¼ì° ë„ì°©í•˜ëŠ” í¸ì¸ê°€ìš”?", "ì¹œêµ¬ë“¤ ì‚¬ì´ì—ì„œ ì–´ë–¤ ì—­í• ì¸ ê²ƒ ê°™ë‚˜ìš”? (ë¶„ìœ„ê¸° ë©”ì´ì»¤, ë¦¬ë”, ê²½ì²­ì ë“±)", "ê²Œì„ì„ ì¦ê¸°ëŠ” í¸ì¸ê°€ìš”? ì–´ë–¤ ê²Œì„ì„ ì£¼ë¡œ í•˜ë‚˜ìš”?", "ìš”ì¦˜ ìœ íŠœë¸Œì—ì„œ ì£¼ë¡œ ì–´ë–¤ ì˜ìƒì„ ë³´ë‚˜ìš”?", "ë°°ë‹¬ ìŒì‹ vs ì§ì ‘ ìš”ë¦¬, ì–´ëŠ ìª½ì„ ë” ì„ í˜¸í•˜ë‚˜ìš”?", "SNSëŠ” ì£¼ë¡œ ì–´ë–¤ í”Œë«í¼ì„ ì‚¬ìš©í•˜ë‚˜ìš”?", "ì˜·ì€ ì£¼ë¡œ ì–´ë””ì„œ êµ¬ë§¤í•˜ë‚˜ìš”? ì˜¨ë¼ì¸ vs ì˜¤í”„ë¼ì¸?", "ì¼ê¸°ë¥¼ ì“°ê±°ë‚˜ ê¸°ë¡ì„ ë‚¨ê¸°ëŠ” ìŠµê´€ì´ ìˆë‚˜ìš”?", "ìƒˆë²½ê¹Œì§€ ê¹¨ì–´ìˆëŠ” ì¼ì´ ìì£¼ ìˆë‚˜ìš”? ì£¼ë¡œ ë­˜ í•˜ë‚˜ìš”?", "ë²„ìŠ¤ë‚˜ ì§€í•˜ì² ì—ì„œ ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë©° ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?", "ì¹œêµ¬ì—ê²Œ ê³ ë¯¼ ìƒë‹´ì„ ìì£¼ í•˜ëŠ” í¸ì¸ê°€ìš”, ë°›ëŠ” í¸ì¸ê°€ìš”?", "ê³„íšì„ ì„¸ì›Œì„œ ì›€ì§ì´ëŠ” íƒ€ì…ì¸ê°€ìš”, ì¦‰í¥ì ì¸ íƒ€ì…ì¸ê°€ìš”?", "ê³¼ì œë‚˜ ì‹œí—˜ ê³µë¶€ëŠ” ë¯¸ë¦¬ë¯¸ë¦¬ í•˜ëŠ” í¸ì¸ê°€ìš”, ë²¼ë½ì¹˜ê¸° íƒ€ì…ì¸ê°€ìš”?", "ë¬¼ê±´ì„ ìì£¼ ìƒì–´ë²„ë¦¬ëŠ” í¸ì¸ê°€ìš”?", "ì¹œêµ¬ë“¤ê³¼ ì£¼ë¡œ ì–´ë–¤ í™œë™ì„ í•˜ë©° ë…¸ë‚˜ìš”?"], preferences: ["ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆê³¼ ê·¸ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ìµœê·¼ì— ì¬ë¯¸ìˆê²Œ ë³¸ ì˜í™”ë‚˜ ë“œë¼ë§ˆê°€ ìˆë‚˜ìš”? ì–´ë–¤ ì ì´ ì¢‹ì•˜ë‚˜ìš”?", "'ì¸ìƒ ì±…'ì´ë¼ê³  ë¶€ë¥¼ ë§Œí•œ ì±…ì´ ìˆë‹¤ë©´ ì†Œê°œí•´ì£¼ì„¸ìš”.", "ê°•ì•„ì§€ vs ê³ ì–‘ì´, ì–´ëŠ ìª½ì„ ë” ì¢‹ì•„í•˜ì„¸ìš”?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìŒì‹ê³¼ ê°€ì¥ ì‹«ì–´í•˜ëŠ” ìŒì‹ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ì—¬í–‰ì„ ê°„ë‹¤ë©´ ì‚°ê³¼ ë°”ë‹¤ ì¤‘ ì–´ë””ë¡œ ê°€ê³  ì‹¶ìœ¼ì„¸ìš”?", "ìœ íŠœë¸Œ ì±„ë„ì„ í•˜ë‚˜ ì¶”ì²œí•´ì¤€ë‹¤ë©´ìš”?", "ì„¸ìƒì—ì„œ ê°€ì¥ ë§›ìˆëŠ” ë¼ë©´ ë“ì´ëŠ” ë²•ì„ ì„¤ëª…í•´ì¤€ë‹¤ë©´?", "ì¹˜í‚¨ì€ í›„ë¼ì´ë“œ vs ì–‘ë…, ì–´ëŠ ìª½ì¸ê°€ìš”?", "ì¢‹ì•„í•˜ëŠ” ìŒì•… ì¥ë¥´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ì˜í™”ê´€ vs ì§‘ì—ì„œ OTT, ì˜í™”ëŠ” ì–´ë””ì„œ ë³´ëŠ” ê²Œ ì¢‹ë‚˜ìš”?", "ìƒˆë²½ê°ì„± vs ì•„ì¹¨í–‡ì‚´, ì–´ëŠ ìª½ì´ ë” ì¢‹ì€ê°€ìš”?", "ë”ìš´ ì—¬ë¦„ vs ì¶”ìš´ ê²¨ìš¸, ì°¨ë¼ë¦¬ ê²¬ë”œ ë§Œí•œ ìª½ì€?", "ì•¡ì…˜ ì˜í™” vs ë¡œë§¨ìŠ¤ ì˜í™”, ì„ í˜¸í•˜ëŠ” ì¥ë¥´ëŠ”?", "ë‹¨ë§› vs ì§ ë§›, í‰ì†Œì— ë” ë‹¹ê¸°ëŠ” ìª½ì€?", "ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ vs ë”°ëœ»í•œ ë¼ë–¼?", "ë¹„ ì˜¤ëŠ” ë‚ ì˜ ë§¤ë ¥ì— ëŒ€í•´ ì–´ë–»ê²Œ ìƒê°í•˜ë‚˜ìš”?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìƒ‰ê¹”ê³¼ ê·¸ ì´ìœ ëŠ”?", "í¸ì˜ì  ì‚¼ê°ê¹€ë°¥ vs ì»µë¼ë©´, í¸ì˜ì  ê°€ë©´ ê¼­ ì‚¬ëŠ” ê±´?", "í˜¼ë°¥ vs ì—¬ëŸ¿ì´ ë¨¹ê¸°, ì‹ì‚¬ëŠ” ì–´ë–»ê²Œ í•˜ëŠ” ê²Œ ì¢‹ë‚˜ìš”?", "ë„ì‹œ vs ì‹œê³¨, ì‚´ê¸°ì—ëŠ” ì–´ë””ê°€ ë” ì¢‹ì„ê¹Œìš”?", "ì•„ì¹¨ ì¼ì° vs ì €ë… ëŠ¦ê²Œ, ìƒì‚°ì„±ì´ ë” ë†’ì€ ì‹œê°„ëŒ€ëŠ”?", "ì±… vs ì˜í™”, ê°™ì€ ìŠ¤í† ë¦¬ë¼ë©´ ì–´ë–¤ ë§¤ì²´ë¡œ ì ‘í•˜ê³  ì‹¶ë‚˜ìš”?", "ì¡°ìš©í•œ ì¹´í˜ vs ë¶ì ì´ëŠ” ì¹´í˜, ì–´ëŠ ë¶„ìœ„ê¸°ê°€ ì¢‹ë‚˜ìš”?", "ì°½ê°€ ìë¦¬ vs ë³µë„ ìë¦¬, êµì‹¤ì´ë‚˜ ì¹´í˜ì—ì„œ ì–´ë”” ì•‰ëŠ” ê±¸ ì„ í˜¸í•˜ë‚˜ìš”?", "ìµìˆ™í•œ ê²ƒ vs ìƒˆë¡œìš´ ê²ƒ, í‰ì†Œ ì–´ëŠ ìª½ì„ ë” ì„ í˜¸í•˜ë‚˜ìš”?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” íŒ¨ìŠ¤íŠ¸í‘¸ë“œ ë©”ë‰´ëŠ”?", "ìš´ë™í™” vs ìŠ¬ë¦¬í¼, í¸í•œ ì‹ ë°œì€?", "ê³µí¬ ì˜í™”ë¥¼ ì¢‹ì•„í•˜ë‚˜ìš”, ë¬´ì„œì›Œí•˜ë‚˜ìš”?", "ì´ˆì½œë¦¿ vs ì‚¬íƒ•, ë‹¨ ê²ƒ ì¤‘ì—ì„œ ê³ ë¥¸ë‹¤ë©´?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìˆ«ìê°€ ìˆë‚˜ìš”?", "ë‚®ì  vs ë°¤ì , ì–´ëŠ ìª½ì´ ë” ê¿€ì ì¸ê°€ìš”?", "íŒì†¡ vs í•œêµ­ ë…¸ë˜, í‰ì†Œì— ë” ìì£¼ ë“£ëŠ” ìª½ì€?", "í”¼ìëŠ” ë„ìš°ê°€ ì–‡ì€ ê²Œ ì¢‹ë‚˜ìš”, ë‘êº¼ìš´ ê²Œ ì¢‹ë‚˜ìš”?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê°„ì‹ì€ ë¬´ì—‡ì¸ê°€ìš”?"], imagination: ["ë§Œì•½ í•˜ë£¨ ë™ì•ˆ íˆ¬ëª…ì¸ê°„ì´ ë  ìˆ˜ ìˆë‹¤ë©´ ë¬´ì—‡ì„ í•˜ê³  ì‹¶ë‚˜ìš”?", "ë¡œë˜ 1ë“±ì— ë‹¹ì²¨ëœë‹¤ë©´ ê°€ì¥ ë¨¼ì € í•˜ê³  ì‹¶ì€ ì¼ 3ê°€ì§€ëŠ”?", "ë”± í•œ ê°€ì§€ ì´ˆëŠ¥ë ¥ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ëŠ¥ë ¥ì„ ì›í•˜ì„¸ìš”?", "íƒ€ì„ë¨¸ì‹ ì„ íƒ€ê³  ê³¼ê±°ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆë‹¤ë©´, ì–¸ì œë¡œ ê°€ì„œ ë¬´ì—‡ì„ í•˜ê³  ì‹¶ë‚˜ìš”?", "ë¬´ì¸ë„ì— ë”± 3ê°€ì§€ë§Œ ê°€ì ¸ê°ˆ ìˆ˜ ìˆë‹¤ë©´ ë¬´ì—‡ì„ ê°€ì ¸ê°ˆ ê±´ê°€ìš”?", "ë‚´ê°€ ë§Œì•½ ì˜í™”ê°ë…ì´ë¼ë©´, ì–´ë–¤ ì¥ë¥´ì˜ ì˜í™”ë¥¼ ë§Œë“¤ê³  ì‹¶ë‚˜ìš”?", "10ë…„ ì „ì˜ ë‚˜ì—ê²Œ ë”± í•œë§ˆë”” í•´ì¤„ ìˆ˜ ìˆë‹¤ë©´?", "ìì‹ ì„ ë™ë¬¼ì— ë¹„ìœ í•œë‹¤ë©´ ì–´ë–¤ ë™ë¬¼ê³¼ ë‹®ì•˜ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?", "í•˜ë£¨ ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ëŒê³¼ ëª¸ì´ ë°”ë€ë‹¤ë©´ ëˆ„êµ¬ì™€ ë°”ë€Œê³  ì‹¶ë‚˜ìš”?", "ì„¸ìƒì—ì„œ ëª¨ë“  ì±…ì„ ë‹¨ í•œ ê¶Œë§Œ ì½ì„ ìˆ˜ ìˆë‹¤ë©´?", "í‰ìƒ í•œ ê°€ì§€ ìŒì‹ë§Œ ë¨¹ì–´ì•¼ í•œë‹¤ë©´ ë¬´ì—‡ì„ ì„ íƒí•˜ê² ì–´ìš”?", "ì‹œê°„ì„ ë©ˆì¶œ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ìˆœê°„ì— ì‚¬ìš©í•˜ê³  ì‹¶ë‚˜ìš”?", "ìš°ì£¼ì—¬í–‰ vs ì‹¬í•´íƒí—˜, ê¸°íšŒê°€ ì£¼ì–´ì§„ë‹¤ë©´ ì–´ë””ë¡œ ê°€ê³  ì‹¶ë‚˜ìš”?", "ë‚´ê°€ ë§Œì•½ ê°€ìˆ˜ë¼ë©´ ì–´ë–¤ ë…¸ë˜ë¥¼ ë¶€ë¥´ê³  ì‹¶ë‚˜ìš”?", "í‰ìƒ ì—¬ë¦„ vs í‰ìƒ ê²¨ìš¸, í•˜ë‚˜ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤ë©´?", "ë°±ë§Œ ì› vs ë°±ë§Œ íŒ”ë¡œì›Œ, ì–´ëŠ ìª½ì„ ì„ íƒí•˜ì‹œê² ì–´ìš”?", "í•˜ë£¨ ë™ì•ˆ ì—­ì‚¬ ì† ì¸ë¬¼ì´ ë  ìˆ˜ ìˆë‹¤ë©´ ëˆ„ê°€ ë˜ê³  ì‹¶ë‚˜ìš”?", "ë‚˜ë§Œì˜ ì‹ë‹¹ì„ ì—°ë‹¤ë©´ ì–´ë–¤ ì»¨ì…‰ìœ¼ë¡œ ìš´ì˜í•˜ê³  ì‹¶ë‚˜ìš”?", "ë§ˆë²• ì£¼ë¬¸ì„ í•˜ë‚˜ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ì£¼ë¬¸ì„ ë§Œë“¤ê² ì–´ìš”?", "í‰ìƒ ì ì„ ì•ˆ ìë„ ëœë‹¤ë©´ ê·¸ ì‹œê°„ì— ë¬´ì—‡ì„ í•˜ê³  ì‹¶ë‚˜ìš”?", "ì„¸ìƒì˜ ëª¨ë“  ì–¸ì–´ë¥¼ êµ¬ì‚¬í•  ìˆ˜ ìˆë‹¤ë©´ ê°€ì¥ ë¨¼ì € ëˆ„êµ¬ì™€ ëŒ€í™”í•˜ê³  ì‹¶ë‚˜ìš”?", "ë‚´ ì¸ìƒì„ ì˜í™”ë¡œ ë§Œë“ ë‹¤ë©´ ì–´ë–¤ ë°°ìš°ê°€ ë‚˜ë¥¼ ì—°ê¸°í•˜ë©´ ì¢‹ì„ê¹Œìš”?", "ê¸°ì–µì„ í•˜ë‚˜ë§Œ ì§€ìš¸ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ê¸°ì–µì„ ì§€ìš°ê³  ì‹¶ë‚˜ìš”?", "ë°˜ëŒ€ë¡œ, ì ˆëŒ€ ìŠê³  ì‹¶ì§€ ì•Šì€ ê¸°ì–µì€ ë¬´ì—‡ì¸ê°€ìš”?", "í‰ìƒ ë´„ ë‚ ì”¨ë¡œ ì‚´ ìˆ˜ ìˆë‹¤ë©´ ì¢‹ì„ ê²ƒ ê°™ë‚˜ìš”?", "ë‚´ê°€ ë§Œì•½ ì›¹íˆ° ì‘ê°€ë¼ë©´ ì–´ë–¤ ì¥ë¥´ì˜ ì‘í’ˆì„ ê·¸ë¦¬ê³  ì‹¶ë‚˜ìš”?", "ì„¸ìƒì—ì„œ í•˜ë‚˜ì˜ ê·œì¹™ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ê·œì¹™ì„ ë§Œë“¤ê² ì–´ìš”?", "ë¯¸ë˜ì˜ ë‚˜ì—ê²Œì„œ í¸ì§€ê°€ ì˜¨ë‹¤ë©´ ì–´ë–¤ ë‚´ìš©ì´ ì“°ì—¬ ìˆì„ ê²ƒ ê°™ë‚˜ìš”?", "24ì‹œê°„ ë™ì•ˆ ì„¸ìƒ ëª¨ë“  ì‚¬ëŒì´ ë‚´ ë§ì„ ë“£ëŠ”ë‹¤ë©´ ë¬´ìŠ¨ ë§ì„ í•˜ê³  ì‹¶ë‚˜ìš”?", "í‰ìƒ ì‹¤ë‚´ vs í‰ìƒ ì‹¤ì™¸, í•˜ë‚˜ë§Œ ì„ íƒí•´ì•¼ í•œë‹¤ë©´?", "ë‚´ê°€ ë§Œì•½ ëŒ€í†µë ¹ì´ë¼ë©´ ê°€ì¥ ë¨¼ì € í•˜ê³  ì‹¶ì€ ì¼ì€?", "ê³µë£¡ì‹œëŒ€ vs ë¯¸ë˜ì„¸ê³„, í•˜ë£¨ ë™ì•ˆ ì—¬í–‰ ê°„ë‹¤ë©´ ì–´ë””ë¡œ?", "ë‚´ ì¸ìƒì˜ ì‚¬ìš´ë“œíŠ¸ë™ì„ í•œ ê³¡ ê³ ë¥¸ë‹¤ë©´?", "í‰ìƒ í˜¼ì vs í‰ìƒ ëˆ„êµ°ê°€ì™€ í•¨ê»˜, ì–´ëŠ ìª½ì´ ë” ë‚˜ì„ê¹Œìš”?", "ë‚˜ë¥¼ í–¥ê¸°ë¡œ í‘œí˜„í•œë‹¤ë©´ ì–´ë–¤ í–¥ì¼ ê²ƒ ê°™ë‚˜ìš”?"], reflection: ["ê³ ë“±í•™êµ 3ë…„ì„ í•œ ë‹¨ì–´ë¡œ í‘œí˜„í•œë‹¤ë©´?", "ê³ ë“±í•™êµ ìƒí™œ ì¤‘ ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” 'ìˆœê°„'ì€ ì–¸ì œì¸ê°€ìš”?", "ëŒ€í•™êµì— ê°€ë©´ ê°€ì¥ ê¸°ëŒ€ë˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”? (í•™ì—… ì™¸ì ìœ¼ë¡œ)", "ì§€ê¸ˆê¹Œì§€ ì‚´ë©´ì„œ ê°€ì¥ 'ì˜í–ˆë‹¤'ê³  ìƒê°í•˜ëŠ” ì„ íƒì€ ë¬´ì—‡ì¸ê°€ìš”?", "ë°˜ëŒ€ë¡œ, 'ì•„ ê·¸ë•ŒëŠ” ì¢€ ì•„ì‰¬ì› ë‹¤'ê³  ìƒê°í•˜ëŠ” ìˆœê°„ì´ ìˆë‚˜ìš”?", "ê°€ì¥ ìµœê·¼ì— ëˆ„êµ°ê°€ì—ê²Œ 'ê³ ë§™ë‹¤'ê³  ë§í–ˆë˜ ê²½í—˜ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ì£¼ì„¸ìš”.", "1ë…„ ë’¤, ë‚˜ëŠ” ì–´ë–¤ ëª¨ìŠµì´ì—ˆìœ¼ë©´ ì¢‹ê² ë‚˜ìš”?", "ì˜¤ëŠ˜ ë©´ì ‘ ì—°ìŠµì´ ëë‚˜ë©´ ë¬´ì—‡ì„ í•  ê³„íšì¸ê°€ìš”?", "ë‚˜ì—ê²Œ ê°€ì¥ í° ì˜í–¥ì„ ì¤€ ì‚¬ëŒì€ ëˆ„êµ¬ì¸ê°€ìš”?", "ìµœê·¼ 1ë…„ ë™ì•ˆ ê°€ì¥ ë§ì´ ì„±ì¥í–ˆë‹¤ê³  ëŠë¼ëŠ” ë¶€ë¶„ì€?", "ì–´ë ¸ì„ ë•Œì˜ ë‚˜ì™€ ì§€ê¸ˆì˜ ë‚˜, ê°€ì¥ ë‹¬ë¼ì§„ ì ì€ ë¬´ì—‡ì¸ê°€ìš”?", "ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ì¥ì ì´ë¼ê³  ìƒê°í•˜ëŠ” ê²ƒì€?", "ê°œì„ í•˜ê³  ì‹¶ì€ ë‚˜ì˜ ìŠµê´€ì´ ìˆë‚˜ìš”?", "ëˆ„êµ°ê°€ì—ê²Œ ë°›ì€ ë§ ì¤‘ ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” ë§ì€?", "ë‚´ê°€ ìŠ¤ìŠ¤ë¡œì—ê²Œ ìì£¼ í•˜ëŠ” ë§ì´ ìˆë‚˜ìš”?", "í˜ë“¤ ë•Œ ë‚˜ë¥¼ ì§€íƒ±í•´ì£¼ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?", "ê°€ì¥ ë¿Œë“¯í–ˆë˜ ìˆœê°„ì„ ë– ì˜¬ë ¤ë³¸ë‹¤ë©´?", "ì§€ê¸ˆì˜ ë‚´ê°€ ê³¼ê±°ì˜ ë‚˜ì—ê²Œ í•´ì£¼ê³  ì‹¶ì€ ì¡°ì–¸ì€?", "ì˜¬í•´ ì•ˆì— ê¼­ ì´ë£¨ê³  ì‹¶ì€ ëª©í‘œê°€ ìˆë‚˜ìš”?", "ë‚˜ë¥¼ ê°€ì¥ ì˜ í‘œí˜„í•˜ëŠ” ë‹¨ì–´ 3ê°€ì§€ëŠ”?", "ì¹œêµ¬ë“¤ì´ ë‚˜ë¥¼ ì–´ë–»ê²Œ ê¸°ì–µí•´ì£¼ê¸¸ ë°”ë¼ë‚˜ìš”?", "ìµœê·¼ì— ë‚´ê°€ ë³€í–ˆë‹¤ê³  ëŠë‚€ ìˆœê°„ì´ ìˆë‚˜ìš”?", "ë‚˜ì—ê²Œ 'ì§‘'ì´ë€ ì–´ë–¤ ì˜ë¯¸ì¸ê°€ìš”?", "ê°€ì¥ ì†Œì¤‘í•˜ê²Œ ê°„ì§í•˜ê³  ìˆëŠ” ë¬¼ê±´ì€ ë¬´ì—‡ì¸ê°€ìš”?", "10ë…„ í›„ì˜ ë‚˜ëŠ” ì–´ë–¤ ì¼ì„ í•˜ê³  ìˆì„ê¹Œìš”?", "ì§€ê¸ˆê¹Œì§€ ê°€ì¥ ìš©ê¸° ìˆëŠ” ê²°ì •ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?", "ë‚˜ë¥¼ í–‰ë³µí•˜ê²Œ ë§Œë“œëŠ” ê²ƒë“¤ì„ ë‚˜ì—´í•´ë³¸ë‹¤ë©´?", "í›„íšŒí•˜ëŠ” ì¼ì´ ìˆë‹¤ë©´ ë¬´ì—‡ì¸ê°€ìš”?", "ê¼­ ì§€í‚¤ë ¤ê³  ë…¸ë ¥í•˜ëŠ” ë‚˜ë§Œì˜ ì›ì¹™ì´ ìˆë‚˜ìš”?", "ë‚´ê°€ ìƒê°í•˜ëŠ” 'ì„±ê³µ'ì˜ ì˜ë¯¸ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ìŠ¤ìŠ¤ë¡œì—ê²Œ ì¹­ì°¬í•´ì£¼ê³  ì‹¶ì€ ì ì´ ìˆë‚˜ìš”?", "5ë…„ ì „ì˜ ë‚˜ëŠ” ì§€ê¸ˆì˜ ë‚˜ë¥¼ ë³´ê³  ì–´ë–»ê²Œ ìƒê°í• ê¹Œìš”?", "ë‚˜ì—ê²Œ ê°€ì¡±ì´ë€ ì–´ë–¤ ì¡´ì¬ì¸ê°€ìš”?", "ê°€ì¥ ìµœê·¼ì— ìƒˆë¡­ê²Œ ê¹¨ë‹¬ì€ ê²ƒì´ ìˆë‚˜ìš”?", "ë‚´ê°€ ì •ë§ ì¢‹ì•„í•˜ëŠ” ê²ƒê³¼ ì˜í•˜ëŠ” ê²ƒì´ ì¼ì¹˜í•˜ë‚˜ìš”?", "ì¸ìƒì—ì„œ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ì§€ê¸ˆ ì´ ìˆœê°„, ë‚˜ì—ê²Œ í•„ìš”í•œ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?", "ìµœê·¼ì— ê°ì‚¬í–ˆë˜ ìˆœê°„ì„ ë– ì˜¬ë ¤ë³¸ë‹¤ë©´?", "ì•ìœ¼ë¡œì˜ ì¸ìƒì—ì„œ ê¼­ í•´ë³´ê³  ì‹¶ì€ ê²ƒì´ ìˆë‚˜ìš”?", "ë‚˜ë¥¼ ê°€ì¥ ì˜ ì•„ëŠ” ì‚¬ëŒì€ ëˆ„êµ¬ì¼ê¹Œìš”?"] }
        };
        
        // ì „ì—­ ë³€ìˆ˜
        let categories = {};
        let questions = {};
        let answers = [];
        let presets = [];
        let activePresetName = null;
        let currentQuestion = null;
        let isRecording = false;
        let recognition = null;
        let timerInterval = null;
        let seconds = 0;
        let editingQuestionId = null;
        let koreanVoice = null; // TTS ëª©ì†Œë¦¬ ì €ì¥ ë³€ìˆ˜
        
        // ì§‘ì¤‘ ëª¨ë“œ ê´€ë ¨ ì „ì—­ ë³€ìˆ˜
        let isInFocusMode = false;
        let focusState = 'idle'; // idle -> waiting -> listening -> processing
        const FOCUS_DELAY = 500;

        // ìŒì„± ë…¹ìŒ ê´€ë ¨ ì „ì—­ ë³€ìˆ˜
        let audioRecordingEnabled = false;
        let mediaRecorder = null;
        let audioChunks = [];
        let currentAudioBlob = null;
        let audioStream = null;

        // ì´ˆê¸°í™”
        function init() {
            loadInitialData();
            loadAnswersFromStorage();
            loadAudioRecordingState();
            
            updateAllUIs();
            updateAnswerList();
            
            initSpeechRecognition();
            createFocusModeButton();
            loadKoreanVoice();
        }

        function createFocusModeButton() {
            const focusModeBtn = document.createElement('button');
            focusModeBtn.className = 'btn-secondary';
            focusModeBtn.textContent = 'ì§‘ì¤‘ ëª¨ë“œ';
            focusModeBtn.onclick = enterFocusMode;
            document.querySelector('.header').appendChild(focusModeBtn);
        }
        
        function loadKoreanVoice() {
            const setVoice = () => {
                const voices = window.speechSynthesis.getVoices();
                koreanVoice = voices.find(voice => voice.lang === 'ko-KR' && voice.name.includes('Online')) || 
                            voices.find(voice => voice.lang === 'ko-KR');
            };
            if (window.speechSynthesis.onvoiceschanged !== undefined) {
                window.speechSynthesis.onvoiceschanged = setVoice;
            }
            setVoice();
        }

        // --- ë°ì´í„° ê´€ë¦¬ (í”„ë¦¬ì…‹ ì¤‘ì‹¬) ---
        function loadInitialData() {
            const savedPresets = localStorage.getItem('interviewPresets');
            const savedActivePreset = localStorage.getItem('activePresetName');

            if (savedPresets) {
                presets = JSON.parse(savedPresets);
            } else {
                // ì²« ë°©ë¬¸ ì‹œ ê¸°ë³¸ í”„ë¦¬ì…‹ ìƒì„±
                presets = [
                    JSON.parse(JSON.stringify(defaultPresetInterview)),
                    JSON.parse(JSON.stringify(defaultPresetDaily))
                ];
                savePresetsToStorage();
            }

            // í™œì„± í”„ë¦¬ì…‹ ì„¤ì •
            if (savedActivePreset && presets.some(p => p.name === savedActivePreset)) {
                activePresetName = savedActivePreset;
            } else if (presets.length > 0) {
                activePresetName = presets[0].name; // ê¸°ë³¸ê°’ìœ¼ë¡œ ì²« ë²ˆì§¸ í”„ë¦¬ì…‹
            }

            if (activePresetName) {
                loadPresetData(activePresetName);
            }
        }

        function loadPresetData(presetName) {
            const preset = presets.find(p => p.name === presetName);
            if (preset) {
                activePresetName = preset.name;
                categories = JSON.parse(JSON.stringify(preset.categories));
                questions = JSON.parse(JSON.stringify(preset.questions));
                localStorage.setItem('activePresetName', activePresetName);
                updateAllUIs();
            } else {
                console.error(`Preset "${presetName}" not found.`);
                // í´ë°±: ì²« ë²ˆì§¸ í”„ë¦¬ì…‹ ë¡œë“œ
                if (presets.length > 0) {
                    loadPresetData(presets[0].name);
                }
            }
        }

        function savePresetsToStorage() {
            localStorage.setItem('interviewPresets', JSON.stringify(presets));
        }

        function updateActivePresetData() {
            if (!activePresetName) return;
            const presetIndex = presets.findIndex(p => p.name === activePresetName);
            if (presetIndex !== -1) {
                presets[presetIndex].categories = JSON.parse(JSON.stringify(categories));
                presets[presetIndex].questions = JSON.parse(JSON.stringify(questions));
                presets[presetIndex].timestamp = new Date().toISOString();
                savePresetsToStorage();
                updatePresetUI(); // ë³€ê²½ì‚¬í•­(ì‹œê°„, ì§ˆë¬¸ ìˆ˜ ë“±) ì¦‰ì‹œ ë°˜ì˜
            }
        }

        function loadAnswersFromStorage() {
            const storedAnswers = localStorage.getItem('interviewAnswers');
            answers = storedAnswers ? JSON.parse(storedAnswers) : [];
        }
        function saveAnswersToStorage() { localStorage.setItem('interviewAnswers', JSON.stringify(answers)); }

        // --- UI ë Œë”ë§ ---
        function updateAllUIs() {
            updatePresetUI();
            renderCategoryManagement();
            renderQuestionAccordion();
            updateCategorySelectors();
            updateRecentAnswers();
            updateStats();
            document.getElementById('currentPresetNameForCategory').textContent = activePresetName || 'ì—†ìŒ';
        }

        function renderCategoryManagement() {
            const container = document.getElementById('category-list-new');
            if (!container) return;
            
            container.innerHTML = Object.entries(categories).map(([id, name]) => `
                <div class="category-list-item">
                    <div class="category-info-new">
                        <span class="category-name-badge">${id}</span>
                        <span>${name}</span>
                        <span class="question-count-badge">${(questions[id] || []).length}ê°œ ì§ˆë¬¸</span>
                    </div>
                    <div class="answer-actions">
                        <button class="btn-secondary btn-small" onclick='editCategory("${id}")'>ìˆ˜ì •</button>
                        <button class="btn-danger btn-small" onclick='deleteCategory("${id}")'>ì‚­ì œ</button>
                    </div>
                </div>
            `).join('');
        }

        function renderQuestionAccordion() {
            const container = document.getElementById('question-accordion-list');
            if (!container) return;

            container.innerHTML = Object.entries(categories).map(([id, name]) => {
                const questionList = questions[id] || [];
                const questionsHtml = questionList.map((q, index) => `
                    <div class="question-list-item">
                        <span class="question-number-new">${index + 1}.</span>
                        <span class="question-text-view">${q}</span>
                        <div class="answer-actions">
                            <button class="btn-secondary btn-small btn-icon" onclick='editQuestion("${id}", ${index})' title="ìˆ˜ì •">âœï¸</button>
                            <button class="btn-danger btn-small btn-icon" onclick='deleteQuestion("${id}", ${index})' title="ì‚­ì œ">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');

                return `
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)" data-category-id="${id}">
                            <div class="accordion-header-left">
                                <span class="toggle-icon">â–¶</span>
                                <span>${name}</span>
                                <span class="question-count-badge">${questionList.length}ê°œ</span>
                            </div>
                            <div class="accordion-header-right">
                                <button class="btn-primary btn-small" onclick="event.stopPropagation(); openAddQuestionModal('${id}');">+</button>
                            </div>
                        </div>
                        <div class="accordion-content" id="content-${id}">
                            ${questionsHtml.length > 0 ? questionsHtml : '<p style="color: #6b7280; text-align: center; padding: 10px 0;">ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
                            <form class="inline-add-form" onsubmit="inlineAddQuestion(event, '${id}')">
                                <input type="text" placeholder="ìƒˆ ì§ˆë¬¸ì„ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥´ì„¸ìš”..." required>
                            </form>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleAccordion(headerElement) {
            headerElement.classList.toggle('active');
            const content = headerElement.nextElementSibling;
            content.style.display = content.style.display === "block" ? "none" : "block";
        }

        function inlineAddQuestion(event, categoryId) {
            event.preventDefault();
            const input = event.target.querySelector('input');
            const newQuestion = input.value.trim();
            if (newQuestion) {
                if (!questions[categoryId]) questions[categoryId] = [];
                questions[categoryId].push(newQuestion);
                updateActivePresetData();
                renderQuestionAccordion();
                updateStats();
                input.value = '';
                const header = document.querySelector(`.accordion-header[data-category-id="${categoryId}"]`);
                if (header && !header.classList.contains('active')) toggleAccordion(header);
            }
        }

        // --- ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ ---
        function openAddCategoryModal() {
            document.getElementById('categoryModalTitle').textContent = 'ì¹´í…Œê³ ë¦¬ ì¶”ê°€';
            document.getElementById('categoryForm').reset();
            document.getElementById('categoryId').disabled = false;
            document.getElementById('editingCategoryId').value = '';
            document.getElementById('categoryModal').classList.add('active');
        }

        function editCategory(categoryId) {
            document.getElementById('categoryModalTitle').textContent = 'ì¹´í…Œê³ ë¦¬ í¸ì§‘';
            document.getElementById('categoryForm').reset();
            document.getElementById('categoryId').value = categoryId;
            document.getElementById('categoryId').disabled = true;
            document.getElementById('categoryName').value = categories[categoryId];
            document.getElementById('editingCategoryId').value = categoryId;
            document.getElementById('categoryModal').classList.add('active');
        }

        function closeCategoryModal() { document.getElementById('categoryModal').classList.remove('active'); }

        function saveCategory(event) {
            event.preventDefault();
            const categoryId = document.getElementById('categoryId').value.trim();
            const categoryName = document.getElementById('categoryName').value.trim();
            const oldCategoryId = document.getElementById('editingCategoryId').value;

            if (!categoryId || !categoryName) return;
            if (!oldCategoryId && categories[categoryId]) {
                showStatus('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì¹´í…Œê³ ë¦¬ IDì…ë‹ˆë‹¤.', 'error');
                return;
            }

            if (oldCategoryId) categories[oldCategoryId] = categoryName;
            else {
                categories[categoryId] = categoryName;
                if (!questions[categoryId]) questions[categoryId] = [];
            }
            updateActivePresetData();
            updateAllUIs();
            closeCategoryModal();
        }

        function deleteCategory(categoryId) {
            const questionCount = (questions[categoryId] || []).length;
            const confirmMsg = questionCount > 0
                ? `ì´ ì¹´í…Œê³ ë¦¬ì—ëŠ” ${questionCount}ê°œì˜ ì§ˆë¬¸ì´ ìˆìŠµë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ì™€ í•¨ê»˜ ëª¨ë“  ì§ˆë¬¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`
                : `'${categories[categoryId]}' ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            
            showConfirm(confirmMsg, () => {
                delete categories[categoryId];
                delete questions[categoryId];
                updateActivePresetData();
                updateAllUIs();
            });
        }
        
        // --- ì§ˆë¬¸ ê´€ë¦¬ ---
        function openAddQuestionModal(categoryId = null) {
            editingQuestionId = null;
            document.getElementById('modalTitle').textContent = 'ì§ˆë¬¸ ì¶”ê°€';
            document.getElementById('questionForm').reset();
            document.getElementById('questionId').value = '';
            updateCategorySelectors(); // ìµœì‹  ì¹´í…Œê³ ë¦¬ ëª©ë¡ ë°˜ì˜
            document.getElementById('questionCategory').value = categoryId || Object.keys(categories)[0] || '';
            document.getElementById('questionModal').classList.add('active');
        }

        function editQuestion(categoryId, index) {
            editingQuestionId = `${categoryId}-${index}`;
            document.getElementById('modalTitle').textContent = 'ì§ˆë¬¸ í¸ì§‘';
            document.getElementById('questionForm').reset();
            document.getElementById('questionCategory').value = categoryId;
            document.getElementById('questionText').value = questions[categoryId][index];
            document.getElementById('questionId').value = editingQuestionId;
            document.getElementById('questionModal').classList.add('active');
        }

        function closeQuestionModal() { document.getElementById('questionModal').classList.remove('active'); }

        function saveQuestion(event) {
            event.preventDefault();
            const categoryId = document.getElementById('questionCategory').value;
            const text = document.getElementById('questionText').value.trim();
            const questionId = document.getElementById('questionId').value;

            if (!text) return;
            if (!questions[categoryId]) questions[categoryId] = [];

            if (questionId) {
                const [oldCategoryId, index] = questionId.split('-');
                if (oldCategoryId === categoryId) {
                    questions[oldCategoryId][parseInt(index)] = text;
                } else {
                    questions[oldCategoryId].splice(parseInt(index), 1);
                    questions[categoryId].push(text);
                }
            } else {
                questions[categoryId].push(text);
            }
            updateActivePresetData();
            updateAllUIs();
            closeQuestionModal();
        }

        function deleteQuestion(categoryId, index) {
            questions[categoryId].splice(index, 1);
            updateActivePresetData();
            updateAllUIs();
        }
        
        // --- ìŒì„± ì¸ì‹ ---
        function initSpeechRecognition() {
            if (window.location.protocol === 'file:') {
                document.getElementById('setupWarning').style.display = 'block';
                return;
            }
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                try {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognition = new SpeechRecognition();
                    recognition.continuous = true;
                    recognition.interimResults = true;
                    recognition.lang = 'ko-KR';
                    recognition.maxAlternatives = 1;
                    let finalTranscript = '';
                    let lastFinalResultIndex = 0;

                    recognition.onstart = () => {
                        finalTranscript = document.getElementById('transcriptionText').value;
                        if (finalTranscript.length > 0 && !finalTranscript.endsWith(' ')) finalTranscript += ' ';
                        lastFinalResultIndex = 0;
                        showRecognitionStatus('ìŒì„± ì¸ì‹ í™œì„±í™” - ë§ì”€í•´ì£¼ì„¸ìš”', '#7c9473', 'â—');
                    };

                    recognition.onresult = (event) => {
                        let interimTranscript = '';
                        for (let i = lastFinalResultIndex; i < event.results.length; i++) {
                            const transcript = event.results[i][0].transcript;
                            if (event.results[i].isFinal) {
                                finalTranscript += transcript + ' ';
                                lastFinalResultIndex = i + 1;
                            } else {
                                interimTranscript += transcript;
                            }
                        }
                        document.getElementById('transcriptionText').value = finalTranscript + interimTranscript;
                        if (interimTranscript) showRecognitionStatus(`ğŸ”Š ì¸ì‹ ì¤‘...`, '#3b82f6', 'â—');
                    };

                    recognition.onerror = (event) => {
                        let errorMsg = 'ìŒì„± ì¸ì‹ ì˜¤ë¥˜';
                        switch(event.error) {
                            case 'network': errorMsg = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜. ìŒì„± ì¸ì‹ì€ ì¤‘ë‹¨ë˜ì§€ë§Œ ë…¹ìŒì€ ê³„ì†ë©ë‹ˆë‹¤.'; break;
                            case 'not-allowed': errorMsg = 'ë§ˆì´í¬ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.'; break;
                            case 'no-speech': errorMsg = 'ìŒì„±ì´ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤.'; break;
                            case 'audio-capture': errorMsg = 'ë§ˆì´í¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'; break;
                        }
                        showStatus(errorMsg, 'error');
                        showRecognitionStatus(errorMsg, '#ef4444', '!');
                        
                        if (event.error === 'not-allowed' || event.error === 'audio-capture') {
                            stopRecording();
                        }
                    };

                    recognition.onend = () => {
                        if (isRecording) {
                            try { 
                                if (navigator.onLine) recognition.start(); 
                            }
                            catch (e) { 
                                stopRecording(); 
                                showRecognitionStatus('âš ï¸ ì¬ì‹œì‘ ì‹¤íŒ¨', '#ef4444', '!'); 
                            }
                        } else {
                            showRecognitionStatus('ìŒì„± ì¸ì‹ ëŒ€ê¸° ì¤‘', '#6b7280', 'â—‹');
                        }
                    };
                    showRecognitionStatus('ìŒì„± ì¸ì‹ ì¤€ë¹„ ì™„ë£Œ', '#10b981', 'âœ“');
                } catch (e) {
                    showStatus('ìŒì„± ì¸ì‹ì„ ì´ˆê¸°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    showRecognitionStatus('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨', '#ef4444', '!');
                }
            } else {
                showStatus('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                showRecognitionStatus('âŒ ë¸Œë¼ìš°ì € ë¯¸ì§€ì›', '#ef4444', '!');
            }
        }

        function showRecognitionStatus(message, color, icon) {
            const statusBar = document.getElementById('recognitionStatusBar');
            const statusText = document.getElementById('recognitionStatusText');
            const statusIcon = document.getElementById('recognitionStatusIcon');
            
            if (statusBar) {
                statusBar.style.display = 'block';
                const wrapper = statusBar.querySelector('div');
                wrapper.style.backgroundColor = color + '20';
                wrapper.style.borderColor = color;
                statusText.textContent = message;
                statusText.style.color = color;
                statusIcon.textContent = icon;
                statusIcon.style.color = color;
            }
        }

        function toggleRecording() {
            if (!currentQuestion) {
                showStatus('ë¨¼ì € ì§ˆë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            if (isRecording) {
                stopRecording();
            } else {
                startRecording();
            }
        }

        function startRecording() {
            isRecording = true;
            
            if (recognition && navigator.onLine) {
                try {
                    recognition.start();
                } catch (e) {
                    console.warn("ìŒì„± ì¸ì‹ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", e);
                    showStatus('ìŒì„± ì¸ì‹ì€ ì‹œì‘ë˜ì§€ ì•Šì•˜ì§€ë§Œ, ë…¹ìŒì€ ê³„ì†ë©ë‹ˆë‹¤.', 'info');
                }
            } else if (!navigator.onLine) {
                showRecognitionStatus('ì˜¤í”„ë¼ì¸ - ë…¹ìŒë§Œ ì§„í–‰', '#6b7280', 'âŒ¿');
            }

            if (audioRecordingEnabled) {
                startAudioRecording();
            }
            
            if (!isInFocusMode) {
                document.getElementById('recordBtn').textContent = 'ë…¹ìŒ ì¤‘ì§€';
                document.getElementById('recordBtn').classList.add('recording');
                
                let statusMsg = "ë…¹ìŒì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.";
                if (!navigator.onLine && audioRecordingEnabled) {
                    statusMsg = "ì˜¤í”„ë¼ì¸ ìƒíƒœì…ë‹ˆë‹¤. ìŒì„±ë§Œ ë…¹ìŒë©ë‹ˆë‹¤.";
                } else if (!navigator.onLine && !audioRecordingEnabled) {
                    statusMsg = "ì˜¤í”„ë¼ì¸ ìƒíƒœì…ë‹ˆë‹¤. ë‹µë³€ì„ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                }
                showStatus(statusMsg, 'info');

                startTimer();
            }
        }

        function stopRecording() {
            if (!isRecording) return;
            isRecording = false; 

            if (recognition) recognition.stop();
            if (audioRecordingEnabled && mediaRecorder && mediaRecorder.state !== 'inactive') stopAudioRecording();
            
            if (!isInFocusMode) {
                document.getElementById('recordBtn').textContent = 'ë…¹ìŒ ì‹œì‘';
                document.getElementById('recordBtn').classList.remove('recording');
                stopTimer();
                if (document.getElementById('transcriptionText').value.trim()) {
                    showStatus('ë…¹ìŒì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹µë³€ì„ í™•ì¸í•˜ê³  ì €ì¥í•˜ì„¸ìš”.', 'success');
                }
            }
        }

        // --- ìŒì„± ë…¹ìŒ ê¸°ëŠ¥ ---
        function loadAudioRecordingState() {
            const saved = localStorage.getItem('audioRecordingEnabled');
            audioRecordingEnabled = saved === 'true';
            updateAudioRecordingToggle();
        }

        function toggleAudioRecording() {
            audioRecordingEnabled = !audioRecordingEnabled;
            localStorage.setItem('audioRecordingEnabled', audioRecordingEnabled.toString());
            updateAudioRecordingToggle();
            showStatus(audioRecordingEnabled ? 'ìŒì„± ë…¹ìŒ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ìŒì„± ë…¹ìŒ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        function updateAudioRecordingToggle() {
            const toggle = document.getElementById('audioRecordingToggle');
            if (toggle) {
                if (audioRecordingEnabled) toggle.classList.add('active');
                else toggle.classList.remove('active');
            }
        }

        async function startAudioRecording() {
            try {
                audioChunks = [];
                currentAudioBlob = null;
                audioStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                const mimeType = MediaRecorder.isTypeSupported('audio/webm') ? 'audio/webm' : 'audio/mp4';
                mediaRecorder = new MediaRecorder(audioStream, { mimeType });
                
                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    currentAudioBlob = new Blob(audioChunks, { type: mimeType });
                    audioChunks = [];
                    if (audioStream) audioStream.getTracks().forEach(track => track.stop());
                    audioStream = null;
                };
                mediaRecorder.start();
            } catch (error) {
                console.error('Audio recording error:', error);
                showStatus('ì˜¤ë””ì˜¤ ë…¹ìŒì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§ˆì´í¬ ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”.', 'error');
            }
        }

        function stopAudioRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') mediaRecorder.stop();
        }

        function blobToBase64(blob) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }

        function downloadAudio(audioData, timestamp) {
            try {
                const byteString = atob(audioData.split(',')[1]);
                const mimeString = audioData.split(',')[0].split(':')[1].split(';')[0];
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                for (let i = 0; i < byteString.length; i++) ia[i] = byteString.charCodeAt(i);
                const blob = new Blob([ab], { type: mimeString });
                
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `answer_${timestamp}.webm`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Download error:', error);
                showStatus('ì˜¤ë””ì˜¤ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function playAudio(audioData, buttonElement) {
            try {
                const existingAudio = document.querySelector('audio.playing-audio');
                if (existingAudio) {
                    existingAudio.pause();
                    existingAudio.remove();
                }

                const audio = new Audio(audioData);
                audio.className = 'playing-audio';
                audio.play();
                buttonElement.textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
                buttonElement.onclick = () => pauseAudio(audio, buttonElement, audioData);
                audio.onended = () => {
                    buttonElement.textContent = 'â–¶ï¸ ì¬ìƒ';
                    buttonElement.onclick = () => playAudio(audioData, buttonElement);
                    audio.remove();
                };
            } catch (error) {
                console.error('Play error:', error);
                showStatus('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function pauseAudio(audio, buttonElement, audioData) {
            audio.pause();
            buttonElement.textContent = 'â–¶ï¸ ì¬ìƒ';
            buttonElement.onclick = () => resumeAudio(audio, buttonElement, audioData);
        }

        function resumeAudio(audio, buttonElement, audioData) {
            audio.play();
            buttonElement.textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
            buttonElement.onclick = () => pauseAudio(audio, buttonElement, audioData);
        }

        // --- ê¸°íƒ€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
        function switchTab(tabName) {
            document.querySelectorAll('.tab.active, .tab-content.active').forEach(el => el.classList.remove('active'));
            const clickedTab = Array.from(document.querySelectorAll('.tab')).find(tab => tab.getAttribute('onclick').includes(`'${tabName}'`));
            if(clickedTab) clickedTab.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            if (tabName === 'answers') updateAnswerList();
            if (tabName === 'questions') updateAllUIs();
        }
        
        function updateCategorySelectors() {
            const selectors = [document.getElementById('categorySelect'), document.getElementById('questionCategory'), document.getElementById('focusCategorySelect')];
            const categoryOptions = Object.entries(categories).map(([id, name]) => `<option value="${id}">${name}</option>`).join('');
            
            selectors.forEach(selector => {
                if (selector) {
                    const currentVal = selector.value;
                    let firstOption = '';
                    if (selector.id === 'categorySelect' || selector.id === 'focusCategorySelect') {
                        firstOption = '<option value="all">ì „ì²´</option>';
                    }
                    selector.innerHTML = firstOption + categoryOptions;
                    // ê¸°ì¡´ ê°’ì´ ìœ íš¨í•˜ë©´ ìœ ì§€, ì•„ë‹ˆë©´ ê¸°ë³¸ê°’
                    if (Array.from(selector.options).some(opt => opt.value === currentVal)) {
                        selector.value = currentVal;
                    } else {
                        selector.value = selector.options[0]?.value || '';
                    }
                }
            });
        }

        function startTimer() {
            if (timerInterval) return;
            timerInterval = setInterval(() => {
                seconds++;
                updateTimerDisplay();
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = null;
        }

        function resetTimer() {
            stopTimer();
            seconds = 0;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            document.getElementById('timer').textContent = `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function getNewQuestion() {
            const category = document.getElementById('categorySelect').value;
            const availableQuestions = category === 'all' ? Object.values(questions).flat() : questions[category] || [];
            if (availableQuestions.length === 0) {
                showStatus('ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì— ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                currentQuestion = null;
                document.getElementById('questionDisplay').innerHTML = `<div class="question-number">ì§ˆë¬¸ ì—†ìŒ</div><div class="question-text">ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì— ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }
            currentQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            document.getElementById('questionDisplay').innerHTML = `<div class="question-number">ì§ˆë¬¸ (${getQuestionCategory(currentQuestion, true)})</div><div class="question-text">${currentQuestion}</div>`;
            resetTimer();
            clearTranscription();
        }

        function getQuestionCategory(question, returnName = false) {
            for (const [categoryId, questionList] of Object.entries(questions)) {
                if (questionList.includes(question)) return returnName ? (categories[categoryId] || categoryId) : categoryId;
            }
            return returnName ? 'ê¸°íƒ€' : 'unknown';
        }

        async function saveAnswer() {
            const transcription = document.getElementById('transcriptionText').value.trim();
            if (!currentQuestion) {
                if (!isInFocusMode) showStatus('ì§ˆë¬¸ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            if (!transcription && !currentAudioBlob) {
                if (!isInFocusMode) showStatus('ë‹µë³€ ë‚´ìš©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            let audioData = null;
            if (audioRecordingEnabled && currentAudioBlob) {
                try { audioData = await blobToBase64(currentAudioBlob); } 
                catch (error) { console.error('Failed to convert audio:', error); }
            }
            
            const answer = {
                id: Date.now(),
                question: currentQuestion,
                answer: transcription,
                duration: seconds,
                timestamp: new Date().toISOString(),
                category: getQuestionCategory(currentQuestion, true),
                audioData: audioData
            };
            
            answers.unshift(answer);
            saveAnswersToStorage();
            updateAllUIs();
            if (!isInFocusMode) showStatus('ë‹µë³€ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            clearTranscription();
            resetTimer();
            currentAudioBlob = null;
        }

        function clearTranscription() { document.getElementById('transcriptionText').value = ''; }

        function updateRecentAnswers() {
            const container = document.getElementById('recentAnswers');
            if (!container) return;
            const recent = answers.slice(0, 5);
            if (recent.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>ì•„ì§ ì €ì¥ëœ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }
            container.innerHTML = recent.map(answer => `
                <div class="answer-card">
                    <div class="answer-question">${answer.question}</div>
                    <div class="answer-meta">${answer.category} | ${Math.floor(answer.duration / 60)}ë¶„ ${answer.duration % 60}ì´ˆ</div>
                </div>
            `).join('');
        }

        function updateAnswerList() {
            const container = document.getElementById('answerList');
            const searchTerm = document.getElementById('answerSearch')?.value.toLowerCase() || '';
            const filtered = answers.filter(a => !searchTerm || a.question.toLowerCase().includes(searchTerm) || a.answer.toLowerCase().includes(searchTerm));
            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>ì €ì¥ëœ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }
            container.innerHTML = filtered.map((answer, index) => {
                const audioButtons = answer.audioData 
                    ? `<button class="btn-secondary btn-small" id="playBtn_${index}" onclick="playAudio('${answer.audioData.replace(/'/g, "\\'")}', this)">â–¶ï¸ ì¬ìƒ</button>
                    <button class="btn-secondary btn-small" onclick="downloadAudio('${answer.audioData.replace(/'/g, "\\'")}', '${answer.timestamp}')">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>` 
                    : '';
                return `
                <div class="answer-card">
                    <div class="answer-question">${answer.question}</div>
                    <div class="answer-meta">ì¹´í…Œê³ ë¦¬: ${answer.category} | ì‹œê°„: ${Math.floor(answer.duration / 60)}ë¶„ ${answer.duration % 60}ì´ˆ | ${new Date(answer.timestamp).toLocaleString('ko-KR')}</div>
                    <div class="answer-text">${answer.answer.replace(/\n/g, '<br>')}</div>
                    <div class="answer-actions">
                        ${audioButtons}
                        <button class="btn-danger btn-small" onclick="deleteAnswer(${answer.id})">ì‚­ì œ</button>
                    </div>
                </div>
                `;
            }).join('');
        }

        function filterAnswers() { updateAnswerList(); }

        function deleteAnswer(id) {
            showConfirm('ì´ ë‹µë³€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                answers = answers.filter(a => a.id !== id);
                saveAnswersToStorage();
                updateAnswerList();
                updateAllUIs();
                showStatus('ë‹µë³€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
            });
        }

        function clearAllAnswers() {
            if (answers.length > 0) {
                showConfirm('ëª¨ë“  ë‹µë³€ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', () => {
                    answers = [];
                    saveAnswersToStorage();
                    updateAnswerList();
                    updateAllUIs();
                    showStatus('ëª¨ë“  ë‹µë³€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
                });
            }
        }

        function exportAnswers() {
            if (answers.length === 0) {
                showStatus('ë‚´ë³´ë‚¼ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            const dataStr = JSON.stringify(answers, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `interview-answers-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importAnswers(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (!Array.isArray(imported)) throw new Error("Invalid format");

                    showConfirm('ê¸°ì¡´ ë‹µë³€ì„ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ? (ì·¨ì†Œí•˜ë©´ ê¸°ì¡´ ë‹µë³€ì— ì¶”ê°€ë©ë‹ˆë‹¤)', 
                        () => { // í™•ì¸
                            answers = imported;
                            finishImport();
                        },
                        () => { // ì·¨ì†Œ
                            answers = [...answers, ...imported];
                            finishImport();
                        }
                    );
                    function finishImport() {
                        saveAnswersToStorage();
                        updateAnswerList();
                        updateAllUIs();
                        showStatus(`${imported.length}ê°œì˜ ë‹µë³€ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`, 'success');
                    }
                } catch (error) { showStatus('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function updateStats() {
            const totalQuestions = Object.values(questions).reduce((sum, list) => sum + list.length, 0);
            const categoryCount = Object.keys(categories).length;
            const totalAnswers = answers.length;
            const totalTime = answers.reduce((sum, a) => sum + a.duration, 0);
            const stats = {
                statsQuestionsCount: totalQuestions,
                statsCategoryCount: categoryCount,
                statsAnswersCount: totalAnswers,
                statsPracticeTime: Math.round(totalTime / 60),
            };
            for (const [id, value] of Object.entries(stats)) {
                const el = document.getElementById(id);
                if (el) el.textContent = value;
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            if(!statusDiv) return;
            statusDiv.className = `status-message status-${type}`;
            statusDiv.textContent = message;
            setTimeout(() => {
                statusDiv.textContent = '';
                statusDiv.className = '';
            }, 5000);
        }

        // --- ì§‘ì¤‘ ëª¨ë“œ ---
        function enterFocusMode() {
            document.getElementById('focusModeContainer').classList.add('active');
            isInFocusMode = true;
            updateCategorySelectors(); // í¬ì»¤ìŠ¤ ëª¨ë“œ ì…€ë ‰í„° ì—…ë°ì´íŠ¸
            resetFocusMode();
            clearTranscription();
        }

        function exitFocusMode() {
            if (isRecording) stopRecording();
            document.getElementById('focusModeContainer').classList.remove('active');
            isInFocusMode = false;
            resetFocusMode();
        }
        document.getElementById('exitFocusBtn').addEventListener('click', exitFocusMode);

        function resetFocusMode() {
            focusState = 'idle';
            document.getElementById('focus-question-text').textContent = 'ì§‘ì¤‘ ëª¨ë“œë¥¼ ì‹œì‘í•˜ë ¤ë©´ ì¤‘ì•™ì˜ ì›ì„ í´ë¦­í•˜ì„¸ìš”.';
            document.getElementById('focus-status-text').textContent = '';
            const circle = document.getElementById('focus-circle');
            circle.classList.remove('waiting', 'listening');
        }

        function speak(text, callback) {
            if (!('speechSynthesis' in window)) {
                showStatus('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                if (callback) callback();
                return;
            }
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            if (koreanVoice) utterance.voice = koreanVoice;
            utterance.lang = 'ko-KR';
            utterance.rate = 1.0;
            utterance.onend = () => { if (callback) callback(); };
            window.speechSynthesis.speak(utterance);
        }

        function startFocusModeQuestion() {
            if (focusState !== 'idle') return;
            clearTranscription();
            resetTimer();

            const category = document.getElementById('focusCategorySelect').value;
            const availableQuestions = category === 'all' ? Object.values(questions).flat() : questions[category] || [];
            if (availableQuestions.length === 0) {
                document.getElementById('focus-question-text').textContent = 'ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì— ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.';
                return;
            }
            currentQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            document.getElementById('focus-question-text').textContent = currentQuestion;

            focusState = 'waiting';
            document.getElementById('focus-status-text').textContent = 'ì§ˆë¬¸ì„ ë“¤ì–´ë³´ì„¸ìš”...';
            
            speak(currentQuestion, () => {
                const circle = document.getElementById('focus-circle');
                circle.classList.add('waiting');
                document.getElementById('focus-status-text').textContent = 'ë‹µë³€ì„ ì¤€ë¹„í•˜ì„¸ìš”...';
                startTimer();

                setTimeout(() => {
                    circle.classList.remove('waiting');
                    circle.classList.add('listening');
                    document.getElementById('focus-status-text').textContent = 'ë“£ê³  ìˆìŠµë‹ˆë‹¤...';
                    startRecording();
                    focusState = 'listening';
                }, FOCUS_DELAY);
            });
        }

        function stopAndSaveAnswer() {
            if (focusState !== 'listening') return;
            
            focusState = 'processing';
            document.getElementById('focus-status-text').textContent = 'ë‹µë³€ì„ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...';
            
            stopTimer();
            stopRecording();

            setTimeout(() => {
                saveAnswer();
                document.getElementById('focus-status-text').textContent = 'ë‹µë³€ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œì‘í•˜ë ¤ë©´ ì›ì„ í´ë¦­í•˜ì„¸ìš”.';
                focusState = 'idle';
                document.getElementById('focus-circle').classList.remove('listening');
            }, 1000);
        }

        document.getElementById('focus-circle').addEventListener('click', () => {
            if (focusState === 'idle') startFocusModeQuestion();
            else if (focusState === 'listening') stopAndSaveAnswer();
        });

        // --- í”„ë¦¬ì…‹ ê´€ë¦¬ (ê°œì„ ëœ ë²„ì „) ---
        function updatePresetUI() {
            const container = document.getElementById('presetCardsContainer');
            if (!container) return;
            
            if (presets.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>ì €ì¥ëœ í”„ë¦¬ì…‹ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }
            
            container.innerHTML = '<div class="preset-cards">' + presets.map((preset) => {
                const dateStr = new Date(preset.timestamp).toLocaleString('ko-KR', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
                const questionCount = Object.values(preset.questions).reduce((sum, list) => sum + list.length, 0);
                const categoryCount = Object.keys(preset.categories).length;
                const isActive = preset.name === activePresetName;
                
                return `
                    <div class="preset-card ${isActive ? 'active' : ''}" onclick="loadPresetData('${preset.name}')">
                        <div>
                            <div class="preset-card-header">
                                <div class="preset-card-title">${preset.name}</div>
                            </div>
                            <div class="preset-card-meta">
                                ${questionCount}ê°œ ì§ˆë¬¸ | ${categoryCount}ê°œ ì¹´í…Œê³ ë¦¬<br>
                                ${dateStr}
                            </div>
                        </div>
                        <div class="preset-card-actions" onclick="event.stopPropagation()">
                            <button class="btn-secondary btn-small" onclick="exportPreset('${preset.name}')">ë‹¤ìš´ë¡œë“œ</button>
                            <button class="btn-secondary btn-small" onclick="quickRenamePreset('${preset.name}')">ì´ë¦„ ë³€ê²½</button>
                            <button class="btn-secondary btn-small" onclick="duplicatePreset('${preset.name}')">ë³µì œ</button>
                            <button class="btn-secondary btn-small" onclick="quickDeletePreset('${preset.name}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            }).join('') + '</div>';
        }

        function getNewPresetName() {
            const baseName = "ìƒˆ í”„ë¦¬ì…‹";
            if (!presets.some(p => p.name === baseName)) {
                return baseName;
            }
            let num = 2;
            let newName = `${baseName} (${num})`;
            while (presets.some(p => p.name === newName)) {
                num++;
                newName = `${baseName} (${num})`;
            }
            return newName;
        }

        function addBlankPreset() {
            const newName = getNewPresetName();
            const preset = {
                name: newName,
                categories: {},
                questions: {},
                timestamp: new Date().toISOString()
            };
            presets.push(preset);
            savePresetsToStorage();
            updatePresetUI();
            showStatus(`'${newName}' í”„ë¦¬ì…‹ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
        }

        function quickDeletePreset(presetName) {
            if (presets.length <= 1) {
                showStatus('ë§ˆì§€ë§‰ í”„ë¦¬ì…‹ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            showConfirm(`'${presetName}' í”„ë¦¬ì…‹ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`, () => {
                presets = presets.filter(p => p.name !== presetName);
                if (activePresetName === presetName) {
                    activePresetName = presets[0].name; // ë‹¤ë¥¸ í”„ë¦¬ì…‹ìœ¼ë¡œ í™œì„±í™” ì „í™˜
                    loadPresetData(activePresetName);
                }
                savePresetsToStorage();
                updateAllUIs();
                showStatus('í”„ë¦¬ì…‹ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
            });
        }

        function quickRenamePreset(oldName) {
            showPrompt('ìƒˆ í”„ë¦¬ì…‹ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', oldName, (newName) => {
                newName = newName.trim();
                if (!newName) return;
                
                if (presets.some(p => p.name === newName && p.name !== oldName)) {
                    showStatus('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í”„ë¦¬ì…‹ ì´ë¦„ì…ë‹ˆë‹¤.', 'error');
                    return;
                }
                
                const preset = presets.find(p => p.name === oldName);
                if (preset) {
                    preset.name = newName;
                    if (activePresetName === oldName) {
                        activePresetName = newName;
                        localStorage.setItem('activePresetName', activePresetName);
                    }
                    savePresetsToStorage();
                    updateAllUIs();
                    showStatus('í”„ë¦¬ì…‹ ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                }
            });
        }
        
        function getDuplicatePresetName(originalName) {
            const baseName = `${originalName} ì‚¬ë³¸`;
            if (!presets.some(p => p.name === baseName)) {
                return baseName;
            }
            let num = 2;
            let newName = `${baseName} (${num})`;
            while (presets.some(p => p.name === newName)) {
                num++;
                newName = `${baseName} (${num})`;
            }
            return newName;
        }

        function duplicatePreset(presetNameToDuplicate) {
            const originalPreset = presets.find(p => p.name === presetNameToDuplicate);
            if (!originalPreset) {
                showStatus('ë³µì œí•  í”„ë¦¬ì…‹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            const newPreset = JSON.parse(JSON.stringify(originalPreset)); // Deep copy
            newPreset.name = getDuplicatePresetName(originalPreset.name);
            newPreset.timestamp = new Date().toISOString();

            presets.push(newPreset);
            savePresetsToStorage();
            updatePresetUI();
            showStatus(`'${originalPreset.name}' í”„ë¦¬ì…‹ì´ '${newPreset.name}'(ìœ¼)ë¡œ ë³µì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
        }

        function exportPreset(presetName) {
            const preset = presets.find(p => p.name === presetName);
            if (!preset) return;

            const dataStr = JSON.stringify(preset, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${preset.name}_preset.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importSinglePreset(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedPreset = JSON.parse(e.target.result);
                    if (!importedPreset.name || importedPreset.categories === undefined || importedPreset.questions === undefined) {
                        throw new Error("Invalid preset format");
                    }

                    if (presets.some(p => p.name === importedPreset.name)) {
                        showConfirm(`'${importedPreset.name}' í”„ë¦¬ì…‹ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤. ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?`, () => {
                            const index = presets.findIndex(p => p.name === importedPreset.name);
                            presets[index] = importedPreset;
                            finishImport(importedPreset.name);
                        });
                    } else {
                        presets.push(importedPreset);
                        finishImport(importedPreset.name);
                    }
                } catch (error) {
                    showStatus('ì˜¬ë°”ë¥¸ í”„ë¦¬ì…‹ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.', 'error');
                }
            };
            function finishImport(name) {
                savePresetsToStorage();
                updatePresetUI();
                showStatus(`í”„ë¦¬ì…‹ '${name}'ì„(ë¥¼) ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`, 'success');
            }
            reader.readAsText(file);
            event.target.value = '';
        }

        function exportAllPresets() {
            const dataStr = JSON.stringify(presets, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `all_presets_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importAllPresets(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedPresets = JSON.parse(e.target.result);
                    if (!Array.isArray(importedPresets)) throw new Error("Invalid format");
                    
                    showConfirm('ê°€ì ¸ì˜¨ ë°ì´í„°ë¡œ ëª¨ë“  í”„ë¦¬ì…‹ì„ êµì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                        presets = importedPresets;
                        activePresetName = presets.length > 0 ? presets[0].name : null;
                        savePresetsToStorage();
                        loadPresetData(activePresetName);
                        showStatus('ëª¨ë“  í”„ë¦¬ì…‹ì„ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.', 'success');
                    });
                } catch (error) { showStatus('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }
        
        // --- ì»¤ìŠ¤í…€ ëª¨ë‹¬ í•¨ìˆ˜ ---
        function showConfirm(message, onConfirm, onCancel = () => {}) {
            document.getElementById('confirmModalMessage').innerHTML = message.replace(/\n/g, '<br>');
            const confirmBtn = document.getElementById('confirmModalConfirmBtn');
            const cancelBtn = document.getElementById('confirmModalCancelBtn');
            
            const confirmHandler = () => {
                hideConfirmModal();
                onConfirm();
            };
            const cancelHandler = () => {
                hideConfirmModal();
                onCancel();
            };

            confirmBtn.onclick = confirmHandler;
            cancelBtn.onclick = cancelHandler;
            
            document.getElementById('confirmModal').classList.add('active');
            confirmBtn.focus();
        }

        function hideConfirmModal() {
            document.getElementById('confirmModal').classList.remove('active');
        }

        function showPrompt(message, defaultValue, onConfirm) {
            document.getElementById('promptModalMessage').textContent = message;
            const input = document.getElementById('promptModalInput');
            input.value = defaultValue;
            
            const confirmBtn = document.getElementById('promptModalConfirmBtn');
            const confirmHandler = () => {
                hidePromptModal();
                onConfirm(input.value);
            };
            
            confirmBtn.onclick = confirmHandler;
            input.onkeypress = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    confirmHandler();
                }
            };
            
            document.getElementById('promptModal').classList.add('active');
            input.focus();
            input.select();
        }

        function hidePromptModal() {
            document.getElementById('promptModal').classList.remove('active');
        }

        document.addEventListener('DOMContentLoaded', init);
        document.querySelectorAll('.modal').forEach(modal => modal.addEventListener('click', (e) => { 
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        }));

    </script>
</body>
</html>
